# üåä Event-Stream (Node.js) - Secure Message

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ Event-Stream

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫
- **Node.js**: –û—Å–Ω–æ–≤–Ω–∞—è –ø–ª–∞—Ç—Ñ–æ—Ä–º–∞
- **Express**: HTTP —Å–µ—Ä–≤–µ—Ä (–≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã–π)
- **WebSocket**: –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è
- **libsodium**: –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
- **File System**: –í—Ä–µ–º–µ–Ω–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ

## üìÅ –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞
```
event-stream/
‚îú‚îÄ‚îÄ package.json           # –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏
‚îú‚îÄ‚îÄ app_config.js         # –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è
‚îú‚îÄ‚îÄ src/
‚îÇ   ‚îú‚îÄ‚îÄ app.js            # –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
‚îÇ   ‚îú‚îÄ‚îÄ core/             # –û—Å–Ω–æ–≤–Ω–∞—è –ª–æ–≥–∏–∫–∞
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ crypt/        # –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ —Ñ—É–Ω–∫—Ü–∏–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ fs/           # –§–∞–π–ª–æ–≤–∞—è —Å–∏—Å—Ç–µ–º–∞
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ *.js          # –£—Ç–∏–ª–∏—Ç—ã
‚îÇ   ‚îú‚îÄ‚îÄ http_server/      # HTTP —Å–µ—Ä–≤–µ—Ä
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create_http_server.js
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ post/         # POST –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏
‚îÇ   ‚îÇ   ‚îú‚îÄ‚îÄ create_event_socket/  # WebSocket
‚îÇ   ‚îÇ   ‚îî‚îÄ‚îÄ shared_service/       # –û–±—â–∏–µ —Å–µ—Ä–≤–∏—Å—ã
‚îÇ   ‚îú‚îÄ‚îÄ types/            # –¢–∏–ø—ã –¥–∞–Ω–Ω—ã—Ö
‚îÇ   ‚îú‚îÄ‚îÄ validation/       # –í–∞–ª–∏–¥–∞—Ü–∏—è
‚îÇ   ‚îî‚îÄ‚îÄ libs/             # –ë–∏–±–ª–∏–æ—Ç–µ–∫–∏
‚îî‚îÄ‚îÄ docs/                 # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

## üîß –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### app.js - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞
```javascript
// –ó–∞–ø—É—Å–∫ HTTP —Å–µ—Ä–≤–µ—Ä–∞
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è shared_service
// –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –ø–æ—Ä—Ç–æ–≤ –∏ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
```

### core/crypt/ - –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
```javascript
// libsodium-wrappers –¥–ª—è:
// - Curve25519 —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ
// - Ed25519 –ø–æ–¥–ø–∏—Å–∏
// - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
// - –•–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ
```

### http_server/ - HTTP API
```javascript
// Endpoints:
// - /events (POST) - –æ—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π
// - /events (GET) - SSE –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ
// - /crypto (POST) - –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏
```

## üåê API Endpoints

### –°–æ–±—ã—Ç–∏—è
```
POST /events
- –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–±—ã—Ç–∏–π –≤ —Å–∏—Å—Ç–µ–º—É
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∏ –æ–±—Ä–∞–±–æ—Ç–∫–∞
- –†–∞—Å—Å—ã–ª–∫–∞ –ø–æ–¥–ø–∏—Å—á–∏–∫–∞–º

GET /events
- Server-Sent Events (SSE)
- –ü–æ–¥–ø–∏—Å–∫–∞ –Ω–∞ —Å–æ–±—ã—Ç–∏—è
- –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ —Ç–∏–ø–∞–º
```

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
```
POST /crypto
- –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π
- –®–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ/—Ä–∞—Å—à–∏—Ñ—Ä–æ–≤–∫–∞
- –¶–∏—Ñ—Ä–æ–≤—ã–µ –ø–æ–¥–ø–∏—Å–∏
- –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π
```

## üîÑ –í–∑–∞–∏–º–æ–¥–µ–π—Å—Ç–≤–∏–µ —Å –¥—Ä—É–≥–∏–º–∏ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞–º–∏

### Frontend ‚Üî Event-Stream
```javascript
// SSE –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
// HTTP POST –¥–ª—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–±—ã—Ç–∏–π
// WebSocket –¥–ª—è –∞–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω–æ–≥–æ –∫–∞–Ω–∞–ª–∞
// Crypto API –¥–ª—è —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏—è
```

### Backend ‚Üî Event-Stream
```javascript
// HTTP API –¥–ª—è —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏–∏
// –û–±–º–µ–Ω —Å–æ–±—ã—Ç–∏—è–º–∏
// –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
```

## üíæ –•—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö

### Memory Storage
```javascript
// –ê–∫—Ç–∏–≤–Ω—ã–µ SSE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è
// –û—á–µ—Ä–µ–¥—å —Å–æ–±—ã—Ç–∏–π
// –ö—ç—à —Å–µ—Å—Å–∏–π
// –í—Ä–µ–º–µ–Ω–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
```

### File System
```javascript
// –õ–æ–≥–∏ —Å–æ–±—ã—Ç–∏–π
// –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
// –í—Ä–µ–º–µ–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã
// Backup –¥–∞–Ω–Ω—ã—Ö
```

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –í–∞–ª–∏–¥–∞—Ü–∏—è
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ö–æ–¥—è—â–∏—Ö –¥–∞–Ω–Ω—ã—Ö
// –í–∞–ª–∏–¥–∞—Ü–∏—è JSON —Å—Ç—Ä—É–∫—Ç—É—Ä
// –°–∞–Ω–∏—Ç–∏–∑–∞—Ü–∏—è –ø–∞—Ä–∞–º–µ—Ç—Ä–æ–≤
// Rate limiting
```

### –ö—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
```javascript
// –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–µ–π
// –í–∞–ª–∏–¥–∞—Ü–∏—è –∫–ª—é—á–µ–π
// –ë–µ–∑–æ–ø–∞—Å–Ω–æ–µ —Ö—Ä–∞–Ω–µ–Ω–∏–µ
// –ó–∞—â–∏—â–µ–Ω–Ω–∞—è –ø–µ—Ä–µ–¥–∞—á–∞
```

## üöÄ –†–∞–∑–≤–µ—Ä—Ç—ã–≤–∞–Ω–∏–µ

### Development
```bash
cd event-stream
npm install
npm start
# –°–µ—Ä–≤–µ—Ä –Ω–∞ http://localhost:3000
```

### Production
```bash
# PM2 –¥–ª—è production
npm install -g pm2
pm2 start src/app.js --name event-stream

# Docker
docker build -t event-stream .
docker run -p 3000:3000 event-stream
```

### Environment Variables
```bash
# –ü–æ—Ä—Ç —Å–µ—Ä–≤–µ—Ä–∞
PORT=3000

# –†–µ–∂–∏–º —Ä–∞–±–æ—Ç—ã
NODE_ENV=production

# –ü—É—Ç–∏ –∫ –¥–∞–Ω–Ω—ã–º
DATA_PATH=./data

# CORS –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
CORS_ORIGINS=http://localhost:5173,http://localhost:8080
```

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ
```javascript
// –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ª–æ–≥–∏
// –£—Ä–æ–≤–Ω–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è
// –†–æ—Ç–∞—Ü–∏—è —Ñ–∞–π–ª–æ–≤
// Error tracking
```

### –ú–µ—Ç—Ä–∏–∫–∏
```javascript
// –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–π SSE
// –í—Ä–µ–º—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–±—ã—Ç–∏–π
// –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –ø–∞–º—è—Ç–∏
// –ü—Ä–æ–ø—É—Å–∫–Ω–∞—è —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å
```

## üîß –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è

### app_config.js
```javascript
module.exports = {
  port: process.env.PORT || 3000,
  cors: {
    origins: process.env.CORS_ORIGINS?.split(',') || ['*']
  },
  events: {
    maxQueueSize: 1000,
    cleanupInterval: 60000
  },
  crypto: {
    keyExpiration: 3600000 // 1 —á–∞—Å
  }
};
```

## ‚ö†Ô∏è –ß–∞—Å—Ç—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å
- –£—Ç–µ—á–∫–∏ –ø–∞–º—è—Ç–∏ –≤ SSE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è—Ö
- –ü–µ—Ä–µ–ø–æ–ª–Ω–µ–Ω–∏–µ –æ—á–µ—Ä–µ–¥–∏ —Å–æ–±—ã—Ç–∏–π
- –ë–ª–æ–∫–∏—Ä—É—é—â–∏–µ –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—á–µ—Å–∫–∏–µ –æ–ø–µ—Ä–∞—Ü–∏–∏

### –°–µ—Ç—å
- CORS –ø—Ä–æ–±–ª–µ–º—ã —Å frontend
- –¢–∞–π–º–∞—É—Ç—ã SSE —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π
- –ü–æ—Ç–µ—Ä—è WebSocket —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–π

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
- –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è —Å–æ–±—ã—Ç–∏–π
- –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –≤ crypto API
- –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ rate limiting

## üéØ Best Practices

### –ö–æ–¥
```javascript
// –ò—Å–ø–æ–ª—å–∑—É–π async/await
// –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–π –≤—Å–µ –æ—à–∏–±–∫–∏
// –í–∞–ª–∏–¥–∏—Ä—É–π –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
// –õ–æ–≥–∏—Ä—É–π –≤–∞–∂–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
```

### –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
```javascript
// –†–∞–∑–¥–µ–ª—è–π –ª–æ–≥–∏–∫—É –ø–æ –º–æ–¥—É–ª—è–º
// –ò—Å–ø–æ–ª—å–∑—É–π middleware –ø–∞—Ç—Ç–µ—Ä–Ω
// –ü—Ä–∏–º–µ–Ω—è–π dependency injection
// –¢–µ—Å—Ç–∏—Ä—É–π –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –ø—É—Ç–∏
```

### –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å
```javascript
// –í—Å–µ–≥–¥–∞ –≤–∞–ª–∏–¥–∏—Ä—É–π –≤—Ö–æ–¥–Ω—ã–µ –¥–∞–Ω–Ω—ã–µ
// –ò—Å–ø–æ–ª—å–∑—É–π HTTPS –≤ production
// –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–π —Ä–∞–∑–º–µ—Ä –∑–∞–ø—Ä–æ—Å–æ–≤
// –õ–æ–≥–∏—Ä—É–π –ø–æ–¥–æ–∑—Ä–∏—Ç–µ–ª—å–Ω—É—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
```

## üìö –ó–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏

### package.json
```json
{
  "dependencies": {
    "libsodium-wrappers": "^0.7.11",
    "uuid": "^9.0.0",
    "express": "^4.18.0"
  },
  "devDependencies": {
    "nodemon": "^3.0.0"
  }
}
```

## üîó –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –ø—Ä–æ–µ–∫—Ç–æ–º

### Crypto API –¥–ª—è Frontend
```javascript
// –î–æ—Å—Ç—É–ø –∫ libsodium —Ñ—É–Ω–∫—Ü–∏—è–º —á–µ—Ä–µ–∑ HTTP
// –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –∫–ª—é—á–µ–π –Ω–∞ —Å–µ—Ä–≤–µ—Ä–µ
// –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –∫—Ä–∏–ø—Ç–æ–≥—Ä–∞—Ñ–∏—è
// –ö—ç—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∫–ª—é—á–µ–π
```

### Event System
```javascript
// –ö–æ–æ—Ä–¥–∏–Ω–∞—Ü–∏—è –º–µ–∂–¥—É frontend –∏ backend
// –†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
// –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è
// –û–±—Ä–∞–±–æ—Ç–∫–∞ offline —Ä–µ–∂–∏–º–∞
