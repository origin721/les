# Анализ проекта Curve25519 и найденные проблемы

## Дата анализа
27.06.2025, 21:49

## Текущее состояние проекта

### Архитектура
Проект secure-message состоит из трех основных частей:
1. **Frontend (Svelte + TypeScript)** - веб-интерфейс для криптографических операций
2. **Backend (Rust)** - серверная часть
3. **Event-stream (Node.js)** - сервис для обработки событий и криптографии

### Реализованная функциональность Curve25519

#### Компоненты интерфейса:
1. **Curve25519Page.svelte** - главная страница с табами
2. **Curve25519PageKeys.svelte** - управление ключами (генерация, добавление партнеров)
3. **Curve25519PageEncrypt.svelte** - шифрование сообщений
4. **Curve25519PageDecrypt.svelte** - расшифровка сообщений

#### Хранилище данных:
- **apiKeysStore** - Svelte store для управления ключами
- Поддержка моих ключей (KeyPair) и ключей партнеров (PartnerKey)
- Методы добавления, удаления, поиска ключей

#### Криптографические функции:
Импортируются из event-stream модуля:
- `encrypt_curve25519` - базовое шифрование
- `encrypt_curve25519_verify` - шифрование с подписью
- `decrypt_curve25519` - базовая расшифровка
- `decrypt_curve25519_verify` - расшифровка с проверкой подписи
- `generate_keys_curve25519` - генерация пары ключей

## Найденные проблемы и недоработки

### 1. Отсутствие функции копирования в компоненте шифрования
**Файл:** `front/src/pages/curve25519_page/ui/Curve25519PageEncrypt.svelte`
**Проблема:** Нет кнопки "Копировать" для зашифрованного текста
**Решение:** Добавить функцию `copyEncryptedText()` и кнопку копирования

### 2. Отсутствие персистентности данных
**Проблема:** Ключи не сохраняются между сессиями браузера
**Решение:** Добавить сохранение в localStorage или IndexedDB

### 3. Отсутствие валидации ключей
**Проблема:** Нет проверки формата публичных ключей при добавлении партнеров
**Решение:** Добавить валидацию формата ключей

### 4. Отсутствие экспорта/импорта ключей
**Проблема:** Нет возможности экспортировать или импортировать ключи
**Решение:** Добавить функции экспорта в файл и импорта из файла

### 5. Отсутствие уведомлений об успешных операциях
**Проблема:** Пользователь не получает обратную связь об успешном копировании
**Решение:** Добавить toast-уведомления

## Приоритетные задачи для доработки

### Высокий приоритет:
1. **Добавить кнопку копирования в компонент шифрования**
2. **Реализовать сохранение ключей в localStorage**
3. **Добавить валидацию ключей**

### Средний приоритет:
4. **Добавить экспорт/импорт ключей**
5. **Реализовать уведомления**
6. **Добавить подтверждения для критических операций**

### Низкий приоритет:
7. **Улучшить UX интерфейса**
8. **Добавить справочную информацию**

## Технические детали

### Структура KeyPair:
```typescript
interface KeyPair {
  id: string;
  publicKey: string;
  privateKey: string;
  name: string;
  createdAt: Date;
}
```

### Структура PartnerKey:
```typescript
interface PartnerKey {
  id: string;
  publicKey: string;
  name: string;
  description?: string;
  createdAt: Date;
}
```

### Используемые стили:
- Tailwind CSS для стилизации
- Кастомный `btn` класс из `front/src/styles/button`

## Следующие шаги

1. Начать с исправления отсутствующей кнопки копирования в Curve25519PageEncrypt.svelte
2. Реализовать персистентность данных через localStorage
3. Добавить валидацию ключей
4. Протестировать функциональность
5. Добавить дополнительные улучшения UX

## Файлы для изменения

### Первоочередные:
- `front/src/pages/curve25519_page/ui/Curve25519PageEncrypt.svelte`
- `front/src/stores/api_keys_store.ts`

### Дополнительные:
- `front/src/pages/curve25519_page/ui/Curve25519PageKeys.svelte`
- `front/src/core/validation/` (новые файлы)
- `front/src/components/` (toast компоненты)
