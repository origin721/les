const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/-1_tmp_test-CQ62IE-t.js","assets/index-CPioufBD.js","assets/index-D6sU3GtJ.css","assets/0_initialization-CIvgY8Vi.js","assets/1_accounts_friends-bsAPHTv6.js","assets/decrypt_curve25519_from_pass-CBE2Th_U.js","assets/2_accounts_versioning-DqzJSIEP.js","assets/3_rooms_versioning-B3mdw3iv.js","assets/4_accounts_room_ids-BLtpsTLS.js","assets/5_entities_version_fields-CJi0uK-g.js"])))=>i.map(i=>d[i]);
var eo=Object.defineProperty;var ro=(s,t,e)=>t in s?eo(s,t,{enumerable:!0,configurable:!0,writable:!0,value:e}):s[t]=e;var zr=(s,t,e)=>ro(s,typeof t!="symbol"?t+"":t,e);import{K as I,I as g,M as Hr,ay as Yr,az as W,aA as so,a as Je,f as O,D as G,x as d,n as R,d as $,l as c,y,S as l,E as a,p as Qr,a5 as Kr,m as kt,e as Zr,Z as Jr,N as F,aB as oo,t as j,_ as er,w as v,a6 as tt,C as Pt,aC as no,a0 as Xr,o as io,j as V,a4 as X,a7 as ao,R as ie,L as Xe,aD as Gr,z as co,i as lo,k as Ut,ad as ae}from"./index-CPioufBD.js";import{B as vo}from"./BasePage-CBg-9Ubx.js";import{s as Wr}from"./index-XHeJSK2U.js";const Lt={0:"0_initialization",1:"1_accounts_friends",2:"2_accounts_versioning",3:"3_rooms_versioning",4:"4_accounts_room_ids",5:"5_entities_version_fields"},Fr=0,ve={MAIN_LES_STORE_V1:"main_les_store_v1",DB_STATE_MANAGER_V1:"db_state_manager_v1",ENTITY_VERSIONS_V1:"entity_versions_v1"},It={IDLE:"idle",UPDATE_STARTED:"update_started",UPDATE_SUCCESS:"update_success",UPDATE_FAILED:"update_failed",CORRUPTED:"corrupted"},uo=1;function rr(){return new Promise((s,t)=>{const e=indexedDB.open(ve.DB_STATE_MANAGER_V1,uo);e.onupgradeneeded=r=>{const o=e.result;o.objectStoreNames.contains("db_states")||(o.createObjectStore("db_states",{keyPath:"id"}),g("‚úÖ –°–æ–∑–¥–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ db_states"))},e.onsuccess=()=>{s(e.result)},e.onerror=()=>{I("‚ùå –û—à–∏–±–∫–∞ –æ—Ç–∫—Ä—ã—Ç–∏—è –±–∞–∑—ã —Å–æ—Å—Ç–æ—è–Ω–∏–π:",e.error),t(e.error)}})}async function vt(s){try{const t=await rr();return new Promise((e,r)=>{const o=t.transaction(["db_states"],"readonly"),u=o.objectStore("db_states").get(s);u.onsuccess=()=>{e(u.result||null)},u.onerror=()=>{r(u.error)},o.oncomplete=()=>{t.close()}})}catch(t){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î:",t),null}}async function te(s){try{const t=await rr();return new Promise((e,r)=>{const o=t.transaction(["db_states"],"readwrite"),i=o.objectStore("db_states");s.lastUpdated=Date.now();const u=i.put(s);u.onsuccess=()=>{g("‚úÖ –°–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –æ–±–Ω–æ–≤–ª–µ–Ω–æ:",{dbName:s.dbName,version:s.version,status:s.status}),e()},u.onerror=()=>{I("‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î:",u.error),r(u.error)},o.oncomplete=()=>{t.close()}})}catch(t){throw I("‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î:",t),t}}async function Xt(s,t,e,r,o){try{let i=await vt(s);i?(i.status=t,e!==void 0&&(i.version=e),r!==void 0&&(i.targetVersion=r),o!==void 0&&(i.errorMessage=o)):i={id:s,dbName:s,version:e||0,status:t,lastUpdated:Date.now()},await te(i)}catch(i){throw I("‚ùå –û—à–∏–±–∫–∞ —É—Å—Ç–∞–Ω–æ–≤–∫–∏ —Å—Ç–∞—Ç—É—Å–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è:",i),i}}async function ts(s){const t=await vt(s);return(t==null?void 0:t.version)||0}async function es(s){const t=await vt(s);return t?t.status!==It.UPDATE_STARTED:!0}async function ce(){try{const s=await rr();return new Promise((t,e)=>{const r=s.transaction(["db_states"],"readonly"),i=r.objectStore("db_states").getAll();i.onsuccess=()=>{t(i.result)},i.onerror=()=>{e(i.error)},r.oncomplete=()=>{s.close()}})}catch(s){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤—Å–µ—Ö —Å–æ—Å—Ç–æ—è–Ω–∏–π –ë–î:",s),[]}}async function rs(s,t,e){try{let r=await vt(s);r||(r={id:s,dbName:s,version:t,status:It.UPDATE_STARTED,lastUpdated:Date.now()}),r.migrationStartTime=Date.now(),r.targetVersion=e,r.executedMigrations=[],r.migratedTables=[],await te(r),g("‚è±Ô∏è –ù–∞—á–∞—Ç —Ç–∞–π–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏:",{dbName:s,fromVersion:t,toVersion:e})}catch(r){throw I("‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –Ω–∞—á–∞–ª–∞ –º–∏–≥—Ä–∞—Ü–∏–∏:",r),r}}async function ss(s){try{const t=await vt(s);if(!t||!t.migrationStartTime){I("‚ùå –ù–µ –Ω–∞–π–¥–µ–Ω–æ –Ω–∞—á–∞–ª–æ –º–∏–≥—Ä–∞—Ü–∏–∏ –¥–ª—è —Ä–∞—Å—á–µ—Ç–∞ –≤—Ä–µ–º–µ–Ω–∏:",s);return}const e=Date.now();t.migrationEndTime=e,t.migrationDurationMs=e-t.migrationStartTime,await te(t),g("‚úÖ –ó–∞–≤–µ—Ä—à–µ–Ω —Ç–∞–π–º–µ—Ä –º–∏–≥—Ä–∞—Ü–∏–∏:",{dbName:s,durationMs:t.migrationDurationMs,durationSec:Math.round(t.migrationDurationMs/1e3)})}catch(t){throw I("‚ùå –û—à–∏–±–∫–∞ –∑–∞–ø–∏—Å–∏ –æ–∫–æ–Ω—á–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–∏:",t),t}}async function Ct(s){try{const t=await vt(s);if(!t||t.status!==It.UPDATE_STARTED)return!1;const e=10*60*1e3,r=Date.now(),o=t.migrationStartTime?r-t.migrationStartTime:r-t.lastUpdated,i=o>e;return i&&g("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–∞–≤–∏—Å—à–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:",{dbName:s,ageMinutes:Math.round(o/6e4),lastUpdated:new Date(t.lastUpdated).toISOString()}),i}catch(t){return I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –∑–∞–≤–∏—Å—à–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π:",t),!1}}async function Nt(s){try{const t=await vt(s);if(!t){g("‚ÑπÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, —Å–±—Ä–æ—Å –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è:",s);return}t.status=It.IDLE,t.errorMessage="–ú–∏–≥—Ä–∞—Ü–∏—è –±—ã–ª–∞ —Å–±—Ä–æ—à–µ–Ω–∞ –∏–∑-–∑–∞ –∑–∞–≤–∏—Å–∞–Ω–∏—è",delete t.migrationStartTime,delete t.migrationEndTime,delete t.migrationDurationMs,delete t.targetVersion,await te(t),g("üîÑ –°–±—Ä–æ—à–µ–Ω–∞ –∑–∞–≤–∏—Å—à–∞—è –º–∏–≥—Ä–∞—Ü–∏—è:",s)}catch(t){throw I("‚ùå –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –∑–∞–≤–∏—Å—à–µ–π –º–∏–≥—Ä–∞—Ü–∏–∏:",t),t}}async function os(s){try{const t=await vt(s);return t?{totalDuration:t.migrationDurationMs||0,lastMigrationDate:t.migrationEndTime?new Date(t.migrationEndTime):null,executedMigrations:t.executedMigrations||[]}:{totalDuration:0,lastMigrationDate:null,executedMigrations:[]}}catch(t){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π:",t),{totalDuration:0,lastMigrationDate:null,executedMigrations:[]}}}const _o=Object.freeze(Object.defineProperty({__proto__:null,canStartUpdate:es,detectStuckMigrations:Ct,endMigrationTimer:ss,getAllDbStates:ce,getDbState:vt,getMigrationStats:os,getPreviousDbVersion:ts,resetStuckMigration:Nt,setUpdateStatus:Xt,startMigrationTimer:rs,updateDbState:te},Symbol.toStringTag,{value:"Module"}));class go{static async addVersionToAllRecords(t,e,r){return new Promise((o,i)=>{try{g(`üîÑ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–∏ ${r} –∫–æ –≤—Å–µ–º –∑–∞–ø–∏—Å—è–º –≤ ${e}...`);const u=t.transaction([e],"readwrite"),_=u.objectStore(e);let f=0,p=0;const h=_.getAll();h.onsuccess=()=>{const w=h.result;if(f=w.length,w.length===0){g(`‚úÖ Store ${e} –ø—É—Å—Ç, –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è`),o();return}let E=0;w.forEach(A=>{if(!A.hasOwnProperty("version")){A.version=r,E++;const T=_.put(A);T.onsuccess=()=>{p++,E--,E===0&&(g(`‚úÖ –í–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ ${e} –∑–∞–≤–µ—Ä—à–µ–Ω–æ:`,{processed:f,updated:p,version:r}),o())},T.onerror=()=>{I(`‚ùå –û—à–∏–±–∫–∞ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –∑–∞–ø–∏—Å–∏ –≤ ${e}:`,T.error),i(T.error)}}}),E===0&&(g(`‚úÖ –í—Å–µ –∑–∞–ø–∏—Å–∏ –≤ ${e} —É–∂–µ –∏–º–µ—é—Ç –≤–µ—Ä—Å–∏—é`),o())},h.onerror=()=>{I(`‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∑–∞–ø–∏—Å–µ–π –∏–∑ ${e}:`,h.error),i(h.error)},u.onerror=()=>{I(`‚ùå –û—à–∏–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ${e}:`,u.error),i(u.error)}}catch(u){I(`‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è ${e}:`,u),i(u)}})}static async validateRecordVersions(t,e){try{g(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π –∑–∞–ø–∏—Å–µ–π, –æ–∂–∏–¥–∞–µ–º–∞—è –≤–µ—Ä—Å–∏—è: ${e}`);const r=Array.from(t.objectStoreNames);let o=!0;const i=[];for(const u of r){const _=await this.validateStoreVersions(t,u,e);i.push(_),_.isValid||(o=!1)}return o?g("‚úÖ –í—Å–µ –∑–∞–ø–∏—Å–∏ –∏–º–µ—é—Ç –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ –≤–µ—Ä—Å–∏–∏"):g("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –∑–∞–ø–∏—Å–∏ —Å –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–º–∏ –≤–µ—Ä—Å–∏—è–º–∏:",i),o}catch(r){return I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–π –∑–∞–ø–∏—Å–µ–π:",r),!1}}static async validateStoreVersions(t,e,r){return new Promise((o,i)=>{try{const f=t.transaction([e],"readonly").objectStore(e).getAll();f.onsuccess=()=>{const p=f.result;let h=0,w=0;p.forEach(A=>{A.hasOwnProperty("version")?A.version<r&&w++:h++});const E=h===0&&w===0;o({storeName:e,totalRecords:p.length,recordsWithoutVersion:h,recordsWithOldVersion:w,isValid:E})},f.onerror=()=>{i(f.error)}}catch(u){i(u)}})}static async updateAllStoresVersions(t,e,r){try{const o=r||Array.from(t.objectStoreNames);g(`üîÑ –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –¥–æ ${e} –≤ stores:`,o);for(const i of o)await this.addVersionToAllRecords(t,i,e);g(`‚úÖ –ú–∞—Å—Å–æ–≤–æ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –∑–∞–≤–µ—Ä—à–µ–Ω–æ –¥–ª—è ${o.length} stores`)}catch(o){throw I("‚ùå –û—à–∏–±–∫–∞ –º–∞—Å—Å–æ–≤–æ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π:",o),o}}static async getVersionStats(t){try{const e=Array.from(t.objectStoreNames),r=[];let o=0,i=0;for(const u of e){const _=await this.getStoreVersionStats(t,u);r.push(_),o+=_.totalRecords,i+=_.recordsWithoutVersion}return{stores:r,summary:{totalStores:e.length,totalRecords:o,totalWithoutVersion:i}}}catch(e){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≤–µ—Ä—Å–∏–π:",e),{stores:[],summary:{totalStores:0,totalRecords:0,totalWithoutVersion:0}}}}static async getStoreVersionStats(t,e){return new Promise((r,o)=>{try{const _=t.transaction([e],"readonly").objectStore(e).getAll();_.onsuccess=()=>{const f=_.result,p={};let h=0;f.forEach(w=>{if(!w.hasOwnProperty("version"))h++;else{const E=String(w.version);p[E]=(p[E]||0)+1}}),r({name:e,totalRecords:f.length,versionsDistribution:p,recordsWithoutVersion:h})},_.onerror=()=>{o(_.error)}}catch(i){o(i)}})}static async removeVersionFromAllRecords(t,e){return new Promise((r,o)=>{try{g(`üîÑ –£–¥–∞–ª–µ–Ω–∏–µ –ø–æ–ª—è version –∏–∑ –≤—Å–µ—Ö –∑–∞–ø–∏—Å–µ–π –≤ ${e}...`);const u=t.transaction([e],"readwrite").objectStore(e),_=u.getAll();_.onsuccess=()=>{const f=_.result;let p=0,h=0;if(f.length===0){g(`‚úÖ Store ${e} –ø—É—Å—Ç`),r();return}f.forEach(w=>{if(w.hasOwnProperty("version")){delete w.version;const E=u.put(w);E.onsuccess=()=>{h++,p++,p===f.length&&(g(`‚úÖ –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –∏–∑ ${e} –∑–∞–≤–µ—Ä—à–µ–Ω–æ:`,{updated:h}),r())},E.onerror=()=>{o(E.error)}}else p++,p===f.length&&r()})},_.onerror=()=>{o(_.error)}}catch(i){o(i)}})}}const ns=Object.freeze(["accounts","friends","rooms"]),mo=Object.freeze(Object.defineProperty({__proto__:null,REQUIRED_STORES:ns},Symbol.toStringTag,{value:"Module"}));async function fo(){try{Hr("üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º legacy —Ä–µ–µ—Å—Ç—Ä –º–∏–≥—Ä–∞—Ü–∏–π...");const s=await W(()=>import("./LEGASY_MIGRATIONS_REGISTRY-D-EDVjfO.js"),[]);if(!s.LEGACY_MIGRATIONS_REGISTRY)throw new Error("Legacy —Ä–µ–µ—Å—Ç—Ä –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç LEGACY_MIGRATIONS_REGISTRY");return g("‚úÖ Legacy —Ä–µ–µ—Å—Ç—Ä –º–∏–≥—Ä–∞—Ü–∏–π –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ"),s.LEGACY_MIGRATIONS_REGISTRY}catch(s){throw I("‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ legacy —Ä–µ–µ—Å—Ç—Ä–∞ –º–∏–≥—Ä–∞—Ü–∏–π:",s),s}}async function ho(s,t){if(!(s<Fr))return g("üöÄ –ò—Å–ø–æ–ª—å–∑—É–µ–º —Ç–æ–ª—å–∫–æ –æ—Å–Ω–æ–≤–Ω–æ–π —Ä–µ–µ—Å—Ç—Ä –º–∏–≥—Ä–∞—Ü–∏–π (legacy –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è)"),{...Lt};g("üì¶ –¢—Ä–µ–±—É—é—Ç—Å—è legacy –º–∏–≥—Ä–∞—Ü–∏–∏, –∑–∞–≥—Ä—É–∂–∞–µ–º –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä:",{oldVersion:s,newVersion:t,minCurrentVersion:Fr});const r=await fo(),o={...r,...Lt};return g("‚úÖ –û–±—ä–µ–¥–∏–Ω–µ–Ω–Ω—ã–π —Ä–µ–µ—Å—Ç—Ä —Å–æ–∑–¥–∞–Ω:",{legacyCount:Object.keys(r).length,currentCount:Object.keys(Lt).length,totalCount:Object.keys(o).length}),o}async function de(s){return new Promise((t,e)=>{try{const r=indexedDB.open(s);r.onsuccess=()=>{const o=r.result.version;r.result.close(),t(o)},r.onerror=()=>{e(r.error)},r.onupgradeneeded=()=>{r.result.close(),t(0)}}catch(r){e(r)}})}async function po(s,t){const e=t[s];if(!e)throw new Error(`–ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –≤–µ—Ä—Å–∏–∏ ${s} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ –æ–±—ä–µ–¥–∏–Ω–µ–Ω–Ω–æ–º —Ä–µ–µ—Å—Ç—Ä–µ`);try{Hr(`üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏: ${e}`);const r=await Yr(Object.assign({"./combined/-1_tmp_test.ts":()=>W(()=>import("./-1_tmp_test-CQ62IE-t.js"),__vite__mapDeps([0,1,2])),"./combined/0_initialization.ts":()=>W(()=>import("./0_initialization-CIvgY8Vi.js"),__vite__mapDeps([3,1,2])),"./combined/1_accounts_friends.ts":()=>W(()=>import("./1_accounts_friends-bsAPHTv6.js"),__vite__mapDeps([4,1,2,5])),"./combined/2_accounts_versioning.ts":()=>W(()=>import("./2_accounts_versioning-DqzJSIEP.js"),__vite__mapDeps([6,1,2,5])),"./combined/3_rooms_versioning.ts":()=>W(()=>import("./3_rooms_versioning-B3mdw3iv.js"),__vite__mapDeps([7,1,2,5])),"./combined/4_accounts_room_ids.ts":()=>W(()=>import("./4_accounts_room_ids-BLtpsTLS.js"),__vite__mapDeps([8,1,2,5])),"./combined/5_entities_version_fields.ts":()=>W(()=>import("./5_entities_version_fields-CJi0uK-g.js"),__vite__mapDeps([9,1,2,5]))}),`./combined/${e}.ts`,3);if(!r.migrationInfo||!r.migrationScheme||!r.migrationData)throw new Error(`–ú–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏ ${e} –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ —ç–∫—Å–ø–æ—Ä—Ç—ã (migrationInfo, migrationScheme, migrationData)`);return g(`‚úÖ –ú–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏ ${e} –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ`),r}catch(r){throw I(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ ${e}:`,r),r}}async function So(s,t){const e=new Map;g("üîÑ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –º–∏–≥—Ä–∞—Ü–∏–π:",{oldVersion:s,newVersion:t});try{const r=await ho(s,t);for(let o=s;o<t;o++){const i=await po(o,r);e.set(o,i)}return g(`‚úÖ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–æ ${e.size} –º–æ–¥—É–ª–µ–π –º–∏–≥—Ä–∞—Ü–∏–π`),e}catch(r){throw I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π:",r),r}}function le(){const s=Object.keys(Lt).map(Number);return s.length>0?Math.max(...s)+1:1}function yo({db:s,realOldVersion:t,newVersion:e}){g("üö® –≠–∫—Å—Ç—Ä–µ–Ω–Ω–æ–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –≤—Å—Ç—Ä–æ–µ–Ω–Ω—ã—Ö –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã");for(let r=0;r<e;r++)r===0&&t<=0&&(g("üì¶ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã 0: –°–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑–æ–≤—ã—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â"),s.objectStoreNames.contains("accounts")||(s.createObjectStore("accounts",{keyPath:"id"}),g("‚úÖ –•—Ä–∞–Ω–∏–ª–∏—â–µ accounts —Å–æ–∑–¥–∞–Ω–æ")),s.objectStoreNames.contains("friends")||(s.createObjectStore("friends",{keyPath:"id"}),g("‚úÖ –•—Ä–∞–Ω–∏–ª–∏—â–µ friends —Å–æ–∑–¥–∞–Ω–æ")),s.objectStoreNames.contains("rooms")||(s.createObjectStore("rooms",{keyPath:"id"}),g("‚úÖ –•—Ä–∞–Ω–∏–ª–∏—â–µ rooms —Å–æ–∑–¥–∞–Ω–æ")),g("‚úÖ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã 0 –∑–∞–≤–µ—Ä—à–µ–Ω–∞")),r===1&&t<=1&&(g("üì¶ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã 1: –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–¥–µ–∫—Å–æ–≤"),g("‚úÖ –≠–∫—Å—Ç—Ä–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã 1 –∑–∞–≤–µ—Ä—à–µ–Ω–∞"));g("üîç –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞–ª–∏—á–∏—è –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö —Ö—Ä–∞–Ω–∏–ª–∏—â..."),s.objectStoreNames.contains("accounts")||(s.createObjectStore("accounts",{keyPath:"id"}),g("‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ accounts")),s.objectStoreNames.contains("friends")||(s.createObjectStore("friends",{keyPath:"id"}),g("‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ friends")),s.objectStoreNames.contains("rooms")||(s.createObjectStore("rooms",{keyPath:"id"}),g("‚úÖ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–æ —Å–æ–∑–¥–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ rooms"))}class wo{static async checkOnAppStart(){try{g("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ...");const t=await ce();for(const e of t)await Ct(e.dbName)?(g("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–∞–≤–∏—Å—à–∞—è –º–∏–≥—Ä–∞—Ü–∏—è, –ø–æ–ø—ã—Ç–∫–∞ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:",e.dbName),await this.recoverFromIncompleteUpdate(e.dbName)):await this.validateVersionConsistency(e.dbName);g("‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Å–æ—Å—Ç–æ—è–Ω–∏—è –±–∞–∑ –¥–∞–Ω–Ω—ã—Ö –∑–∞–≤–µ—Ä—à–µ–Ω–∞")}catch(t){I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –Ω–∞ —Å—Ç–∞—Ä—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:",t)}}static async recoverFromIncompleteUpdate(t){try{g("üîÑ –ù–∞—á–∞–ª–æ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è –ø–æ—Å–ª–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:",t);const e=await vt(t);if(!e){g("‚ÑπÔ∏è –°–æ—Å—Ç–æ—è–Ω–∏–µ –ë–î –Ω–µ –Ω–∞–π–¥–µ–Ω–æ, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è:",t);return}if(!await Ct(t)){g("‚ÑπÔ∏è –ú–∏–≥—Ä–∞—Ü–∏—è –Ω–µ –∑–∞–≤–∏—Å–ª–∞, –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –Ω–µ —Ç—Ä–µ–±—É–µ—Ç—Å—è:",t);return}const o=await de(t);if(g("üìä –°—Ä–∞–≤–Ω–µ–Ω–∏–µ –≤–µ—Ä—Å–∏–π –¥–ª—è –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏—è:",{dbName:t,stateVersion:e.version,realDbVersion:o,targetVersion:e.targetVersion}),e.targetVersion&&o>=e.targetVersion){g("‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –±—ã–ª–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ, –æ–±–Ω–æ–≤–ª—è–µ–º —Å—Ç–∞—Ç—É—Å:",t),await Nt(t);return}await Nt(t),g("üîÑ –í–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–≤–µ—Ä—à–µ–Ω–æ, –º–∏–≥—Ä–∞—Ü–∏—è —Å–±—Ä–æ—à–µ–Ω–∞:",t)}catch(e){I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø–æ—Å–ª–µ –Ω–µ–∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ–≥–æ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è:",e);try{await Nt(t),g("üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–±—Ä–æ—Å —Å—Ç–∞—Ç—É—Å–∞ –≤—ã–ø–æ–ª–Ω–µ–Ω:",t)}catch(r){I("‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º —Å–±—Ä–æ—Å–µ:",r)}}}static async validateVersionConsistency(t){try{const e=await vt(t);if(!e)return!0;const r=await de(t);return e.version!==r?(g("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–æ —Ä–∞—Å—Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–∏–µ –≤–µ—Ä—Å–∏–π:",{dbName:t,stateVersion:e.version,realDbVersion:r}),r>e.version&&(e.version=r,await W(async()=>{const{updateDbState:o}=await Promise.resolve().then(()=>_o);return{updateDbState:o}},void 0).then(({updateDbState:o})=>o(e)),g("‚úÖ –í–µ—Ä—Å–∏—è –≤ —Å–æ—Å—Ç–æ—è–Ω–∏–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∞ –¥–æ —Ä–µ–∞–ª—å–Ω–æ–π:",r)),!1):!0}catch(e){return I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ —Å–æ–≥–ª–∞—Å–æ–≤–∞–Ω–Ω–æ—Å—Ç–∏ –≤–µ—Ä—Å–∏–π:",e),!1}}static async validateDataIntegrity(t){try{g("üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ë–î:",t.name);const{REQUIRED_STORES:e}=await W(async()=>{const{REQUIRED_STORES:i}=await Promise.resolve().then(()=>mo);return{REQUIRED_STORES:i}},void 0),r=e.filter(i=>!t.objectStoreNames.contains(i));if(r.length>0)return I("‚ùå –û—Ç—Å—É—Ç—Å—Ç–≤—É—é—Ç –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ object stores:",r),!1;let o=!0;for(const i of e)try{const f=t.transaction([i],"readonly").objectStore(i).count();await new Promise((p,h)=>{f.onsuccess=()=>p(f.result),f.onerror=()=>h(f.error)})}catch(u){I(`‚ùå –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ store ${i}:`,u),o=!1}return o?g("‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö –ø—Ä–æ–π–¥–µ–Ω–∞:",t.name):I("‚ùå –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –ø—Ä–æ–±–ª–µ–º—ã —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:",t.name),o}catch(e){return I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Ü–µ–ª–æ—Å—Ç–Ω–æ—Å—Ç–∏ –¥–∞–Ω–Ω—ã—Ö:",e),!1}}static async forceResetAllStuckMigrations(){try{g("üö® –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω—ã–π —Å–±—Ä–æ—Å –≤—Å–µ—Ö –∑–∞–≤–∏—Å—à–∏—Ö –º–∏–≥—Ä–∞—Ü–∏–π...");const t=await ce();let e=0;for(const r of t)await Ct(r.dbName)&&(await Nt(r.dbName),e++);g(`‚úÖ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ —Å–±—Ä–æ—à–µ–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–π: ${e}`)}catch(t){I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–º —Å–±—Ä–æ—Å–µ –≤—Å–µ—Ö –º–∏–≥—Ä–∞—Ü–∏–π:",t)}}static async getDiagnosticInfo(){try{const t=await ce(),e=[];let r=0,o=0;for(const i of t){const u=await Ct(i.dbName),_=await de(i.dbName),f=i.version===_;u&&r++,f||o++,e.push({name:i.dbName,stateVersion:i.version,realVersion:_,isStuck:u,versionConsistent:f})}return{databases:e,summary:{total:e.length,stuck:r,inconsistent:o}}}catch(t){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –¥–∏–∞–≥–Ω–æ—Å—Ç–∏—á–µ—Å–∫–æ–π –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏:",t),{databases:[],summary:{total:0,stuck:0,inconsistent:0}}}}}const rt={DB_NAME:"DB_STATE_MANAGER_V2",STORE_NAME:"user_migration_states",VERSION:1};class K{static async getDatabase(){return this.dbPromise||(this.dbPromise=new Promise((t,e)=>{const r=indexedDB.open(rt.DB_NAME,rt.VERSION);r.onupgradeneeded=o=>{const i=o.target.result;if(!i.objectStoreNames.contains(rt.STORE_NAME)){const u=i.createObjectStore(rt.STORE_NAME,{keyPath:"userId"});u.createIndex("userId","userId",{unique:!0}),u.createIndex("currentVersion","currentVersion",{unique:!1})}},r.onsuccess=()=>t(r.result),r.onerror=()=>e(r.error)})),this.dbPromise}static async getUserState(t){const e=await this.getDatabase();return new Promise((r,o)=>{const _=e.transaction([rt.STORE_NAME],"readonly").objectStore(rt.STORE_NAME).get(t);_.onsuccess=()=>r(_.result||null),_.onerror=()=>o(_.error)})}static async updateUserState(t,e){const r=await this.getDatabase(),i={...await this.getUserState(t)||{userId:t,currentVersion:0,completedMigrations:[],migrationHistory:[]},...e};return new Promise((u,_)=>{const h=r.transaction([rt.STORE_NAME],"readwrite").objectStore(rt.STORE_NAME).put(i);h.onsuccess=()=>u(),h.onerror=()=>_(h.error)})}static async getUsersCompletedVersion(t){const e=await this.getDatabase();return new Promise((r,o)=>{const _=e.transaction([rt.STORE_NAME],"readonly").objectStore(rt.STORE_NAME).getAll();_.onsuccess=()=>{const p=_.result.filter(h=>h.completedMigrations.includes(t)).map(h=>h.userId);r(p)},_.onerror=()=>o(_.error)})}static async getAllSystemUserIds(){const t=await this.getDatabase();return new Promise((e,r)=>{const u=t.transaction([rt.STORE_NAME],"readonly").objectStore(rt.STORE_NAME).getAllKeys();u.onsuccess=()=>e(u.result),u.onerror=()=>r(u.error)})}}zr(K,"dbPromise",null);class $o{static async loadMigrationModule(t){const e=Lt[t];if(!e)throw new Error(`–ú–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –≤–µ—Ä—Å–∏–∏ ${t} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞ –≤ —Ä–µ–µ—Å—Ç—Ä–µ`);try{console.log(`üîÑ –ó–∞–≥—Ä—É–∂–∞–µ–º –º–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏: ${e}`);const r=await Yr(Object.assign({"./migrations/combined/-1_tmp_test.ts":()=>W(()=>import("./-1_tmp_test-CQ62IE-t.js"),__vite__mapDeps([0,1,2])),"./migrations/combined/0_initialization.ts":()=>W(()=>import("./0_initialization-CIvgY8Vi.js"),__vite__mapDeps([3,1,2])),"./migrations/combined/1_accounts_friends.ts":()=>W(()=>import("./1_accounts_friends-bsAPHTv6.js"),__vite__mapDeps([4,1,2,5])),"./migrations/combined/2_accounts_versioning.ts":()=>W(()=>import("./2_accounts_versioning-DqzJSIEP.js"),__vite__mapDeps([6,1,2,5])),"./migrations/combined/3_rooms_versioning.ts":()=>W(()=>import("./3_rooms_versioning-B3mdw3iv.js"),__vite__mapDeps([7,1,2,5])),"./migrations/combined/4_accounts_room_ids.ts":()=>W(()=>import("./4_accounts_room_ids-BLtpsTLS.js"),__vite__mapDeps([8,1,2,5])),"./migrations/combined/5_entities_version_fields.ts":()=>W(()=>import("./5_entities_version_fields-CJi0uK-g.js"),__vite__mapDeps([9,1,2,5]))}),`./migrations/combined/${e}.ts`,4);if(!r.migrationInfo)throw new Error(`–ú–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏ ${e} –Ω–µ —Å–æ–¥–µ—Ä–∂–∏—Ç migrationInfo`);return console.log(`‚úÖ –ú–æ–¥—É–ª—å –º–∏–≥—Ä–∞—Ü–∏–∏ ${e} –∑–∞–≥—Ä—É–∂–µ–Ω —É—Å–ø–µ—à–Ω–æ`),r}catch(r){throw console.error(`‚ùå –û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ –º–æ–¥—É–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏ ${e}:`,r),r}}static async getAllMigrations(){const t=[];for(const e of Object.keys(Lt).map(Number))try{const r=await this.loadMigrationModule(e);t.push({...r,version:e+1})}catch(r){console.error(`–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –≤–µ—Ä—Å–∏–∏ ${e}:`,r)}return t.sort((e,r)=>e.version-r.version)}static async checkUserMigrations(t){var u;const e=await K.getUserState(t),r=(e==null?void 0:e.currentVersion)||0,o=le(),i=[];for(let _=r+1;_<=o;_++)(u=e==null?void 0:e.completedMigrations)!=null&&u.includes(_)||i.push(_);return i}static async migrateUser(t){const{currentUser:e,db:r,oldVersion:o,newVersion:i}=t,u=e.id;console.log(`üîÑ –ù–∞—á–∏–Ω–∞–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${u} —Å –≤–µ—Ä—Å–∏–∏ ${o} –¥–æ ${i}`),await K.updateUserState(u,{migrationStartTime:Date.now(),currentVersion:o});try{const _=await this.checkUserMigrations(u);for(const f of _){if(f>i)break;await this.executeUserMigration(t,f);const p=await K.getUserState(u)||{userId:u,currentVersion:o,completedMigrations:[],migrationHistory:[]};await K.updateUserState(u,{currentVersion:f,completedMigrations:[...p.completedMigrations,f]})}await K.updateUserState(u,{migrationEndTime:Date.now(),currentVersion:i}),console.log(`‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${u} –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ`)}catch(_){throw console.error(`‚ùå –û—à–∏–±–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${u}:`,_),await K.updateUserState(u,{migrationEndTime:Date.now(),errorMessage:_ instanceof Error?_.message:"Unknown error"}),_}}static async executeUserMigration(t,e){var h;const{currentUser:r}=t;console.log(`üì¶ –í—ã–ø–æ–ª–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –≤–µ—Ä—Å–∏–∏ ${e} –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${r.id}`);const o=Date.now(),i=e-1,u=await this.loadMigrationModule(i);if(!u)throw new Error(`–ú–∏–≥—Ä–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ ${e} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`);u.migrationData&&await u.migrationData(t);const _=Date.now(),f=_-o;console.log(`‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –≤–µ—Ä—Å–∏–∏ ${e} –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è ${r.id} –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ ${f}–º—Å`);const p=await K.getUserState(r.id);if(p){const w={version:e,fileName:((h=u.migrationInfo)==null?void 0:h.fileName)||`migration_${e}`,schemaDuration:0,dataDuration:f,startTime:o,endTime:_};await K.updateUserState(r.id,{migrationHistory:[...p.migrationHistory,w]})}}static async allUsersCompletedVersion(t,e){const r=await this.scanAllUserIds(t),o=new Set(await K.getUsersCompletedVersion(e));return r.size===o.size&&[...r].every(i=>o.has(i))}static async scanAllUserIds(t){return new Promise((e,r)=>{const u=t.transaction(["accounts"],"readonly").objectStore("accounts").getAll();u.onsuccess=()=>{const _=u.result,f=new Set(_.map(p=>p.id));console.log(`üìä –ù–∞–π–¥–µ–Ω–æ ${f.size} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ:`,[...f]),e(f)},u.onerror=()=>{console.error("‚ùå –û—à–∏–±–∫–∞ —Å–∫–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è accounts –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è userIds:",u.error),r(u.error)}})}static async getUserMigrationStats(t){return await K.getUserState(t)}}class jt{static async scanAllUserIds(t){return new Promise((e,r)=>{const u=t.transaction(["accounts"],"readonly").objectStore("accounts").getAll();u.onsuccess=()=>{const _=u.result,f=new Set(_.map(p=>p.id));e(f)},u.onerror=()=>r(u.error)})}static async allUsersReady(t,e){try{const r=await this.scanAllUserIds(t),o=new Set(await K.getUsersCompletedVersion(e)),i=r.size===o.size&&[...r].every(u=>o.has(u));return console.log(`üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –¥–ª—è –≤–µ—Ä—Å–∏–∏ ${e}:`),console.log(`   - –í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –≤ —Å–∏—Å—Ç–µ–º–µ: ${r.size}`),console.log(`   - –ó–∞–≤–µ—Ä—à–∏–≤—à–∏—Ö –º–∏–≥—Ä–∞—Ü–∏—é: ${o.size}`),console.log(`   - –†–µ–∑—É–ª—å—Ç–∞—Ç: ${i?"‚úÖ –í—Å–µ –≥–æ—Ç–æ–≤—ã":"‚è≥ –û–∂–∏–¥–∞–Ω–∏–µ"}`),i}catch(r){return console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:",r),!1}}static async getPendingUsers(t,e){const r=await this.scanAllUserIds(t),o=new Set(await K.getUsersCompletedVersion(e));return[...r].filter(i=>!o.has(i))}static async getUserReadinessStats(t,e){try{const r=await this.scanAllUserIds(t),o=new Set(await K.getUsersCompletedVersion(e)),i=[...r].filter(h=>!o.has(h)),u=r.size,_=o.size,f=u>0?Math.round(_/u*100):100,p=u===_&&u>0;return{totalUsers:u,completedUsers:_,pendingUsers:i,completionPercentage:f,isReady:p}}catch(r){return console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:",r),{totalUsers:0,completedUsers:0,pendingUsers:[],completionPercentage:0,isReady:!1}}}}let Y=null,dt=null,z=null,gt=!1,mt=0;const Io=5*60*1e3;class ft{static async getConnection(){if(await ft.checkAndRecoverFromFailures(),Y&&!gt)return Y;if(dt)return dt;dt=ft.createNewConnection();try{const t=await dt;return Y=t,ft.setupConnectionHandlers(t),t}catch(t){throw dt=null,t}}static async checkAndRecoverFromFailures(){try{const t=ve.MAIN_LES_STORE_V1;await Ct(t)&&(g("üîß –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ –∑–∞–≤–∏—Å—à–∞—è –º–∏–≥—Ä–∞—Ü–∏—è, –≤—ã–ø–æ–ª–Ω—è–µ–º –≤–æ—Å—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–∏–µ..."),await ft.resetStuckMigration(t)),await wo.checkOnAppStart()}catch(t){I("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ–≤–µ—Ä–∫–µ —Å–æ—Å—Ç–æ—è–Ω–∏—è –ë–î:",t)}}static async resetStuckMigration(t){try{await Nt(t),Y&&(Y.close(),Y=null),dt=null,g("‚úÖ –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è —Å–±—Ä–æ—à–µ–Ω–∞")}catch(e){throw I("‚ùå –û—à–∏–±–∫–∞ —Å–±—Ä–æ—Å–∞ –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω–Ω–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏:",e),e}}static async createNewConnection(){return new Promise(async(t,e)=>{try{const r=ve.MAIN_LES_STORE_V1;if(!await es(r))throw new Error("–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö —É–∂–µ –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è. –î–æ–∂–¥–∏—Ç–µ—Å—å –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è —Ç–µ–∫—É—â–µ–≥–æ –æ–±–Ω–æ–≤–ª–µ–Ω–∏—è.");const i=await de(r),u=await ts(r),_=le();g("üìä –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤–µ—Ä—Å–∏—è—Ö –ë–î:",{currentVersion:i,previousStateVersion:u,targetVersion:_,needsMigration:i<_});const f=Math.max(i,u);f<_&&(await Xt(r,It.UPDATE_STARTED,f,_),await rs(r,f,_));let p=new Map;if(f<_){const E=Date.now();g("üîÑ –ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ –º–æ–¥—É–ª–µ–π –º–∏–≥—Ä–∞—Ü–∏–π c –≤–µ—Ä—Å–∏–∏:",f),p=await So(f,_);const A=Date.now()-E;g(`‚úÖ –ü—Ä–µ–¥–∑–∞–≥—Ä—É–∑–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ –∑–∞ ${A}–º—Å`)}let h=indexedDB.open(r,_),w=i;h.onupgradeneeded=function(E){const A=h.result,T=E.oldVersion??0,st=E.newVersion??_;if(w=T,g("üîÑ IndexDB onupgradeneeded:",{oldVersion:T,newVersion:st,existingStores:Array.from(A.objectStoreNames),detectedCurrentVersion:i,usingRealOldVersion:T}),T!==i&&(g("‚ö†Ô∏è –û–±–Ω–∞—Ä—É–∂–µ–Ω–∞ —Ä–∞—Å—Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –≤–µ—Ä—Å–∏–π, —Å–±—Ä–∞—Å—ã–≤–∞–µ–º –ø—Ä–µ–¥–∑–∞–≥—Ä—É–∂–µ–Ω–Ω—ã–µ –º–∏–≥—Ä–∞—Ü–∏–∏:",{detectedVersion:i,realVersion:T}),p=new Map),T<st)try{p.size===0?yo({db:A,realOldVersion:T,newVersion:st}):ft.runSchemaMigrationsWithTiming(A,T,st,p,r)}catch(Z){throw I("–ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã IndexedDB:",Z),Z}},h.onerror=async function(){var E;I("IndexDB openRequest error:",h.error),await Xt(r,It.UPDATE_FAILED,void 0,void 0,(E=h.error)==null?void 0:E.message),e(h.error)},h.onsuccess=async function(){let E=h.result;g("‚úÖ IndexDB —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ, –≤–µ—Ä—Å–∏—è –ë–î:",E.version);try{const A=ns.filter(T=>!E.objectStoreNames.contains(T));if(A.length>0){I("üö® –û–±–Ω–∞—Ä—É–∂–µ–Ω—ã –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ object stores:",A),g("üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –ø–µ—Ä–µ—Å–æ–∑–¥–∞–Ω–∏–µ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö..."),E.close();const T=indexedDB.deleteDatabase(r);T.onsuccess=()=>{g("‚úÖ –ü–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–∞—è –±–∞–∑–∞ —É–¥–∞–ª–µ–Ω–∞"),setTimeout(()=>{g("üîÑ –ü–µ—Ä–µ–∑–∞–ø—É—Å–∫ —Å–æ–∑–¥–∞–Ω–∏—è –±–∞–∑—ã..."),ft.createNewConnection().then(t).catch(e)},100)},T.onerror=()=>{I("‚ùå –û—à–∏–±–∫–∞ —É–¥–∞–ª–µ–Ω–∏—è –ø–æ–≤—Ä–µ–∂–¥–µ–Ω–Ω–æ–π –±–∞–∑—ã:",T.error),e(T.error)};return}g("‚úÖ –ú–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã –≤—ã–ø–æ–ª–Ω–µ–Ω—ã, –ë–î –≥–æ—Ç–æ–≤–∞ –∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—é"),g("‚ÑπÔ∏è –ú–∏–≥—Ä–∞—Ü–∏–∏ –¥–∞–Ω–Ω—ã—Ö –±—É–¥—É—Ç –≤—ã–ø–æ–ª–Ω–µ–Ω—ã –ø—Ä–∏ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"),await Xt(r,It.UPDATE_SUCCESS,E.version),await ss(r),t(E)}catch(A){I("–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –º–∏–≥—Ä–∞—Ü–∏–π –¥–∞–Ω–Ω—ã—Ö:",A);const T=A instanceof Error?A.message:String(A);await Xt(r,It.UPDATE_FAILED,void 0,void 0,T),E.close(),e(A)}},h.onblocked=function(){so("Database connection blocked"),e(new Error("Database connection blocked"))}}catch(r){I("–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ IndexDB:",r),e(r)}})}static runSchemaMigrationsWithTiming(t,e,r,o,i){var u,_;g("üöÄ –ù–∞—á–∏–Ω–∞–µ–º –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã IndexedDB:",{oldVersion:e,newVersion:r,existingStores:Array.from(t.objectStoreNames)});try{for(let f=e;f<r;f++){const p=f+1;g(`üìã –í—ã–ø–æ–ª–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é —Å—Ö–µ–º—ã —Å –≤–µ—Ä—Å–∏–∏ ${f} –¥–æ ${p}`);const h=o.get(f);if(!h)throw new Error(`–ü—Ä–µ–¥–≤–∞—Ä–∏—Ç–µ–ª—å–Ω–æ –∑–∞–≥—Ä—É–∂–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è –¥–ª—è –≤–µ—Ä—Å–∏–∏ ${f} –Ω–µ –Ω–∞–π–¥–µ–Ω–∞`);const w=Date.now();h.migrationScheme(t);const E=Date.now()-w;g(`‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã ${h.migrationInfo.fileName} –≤—ã–ø–æ–ª–Ω–µ–Ω–∞ –∑–∞ ${E}–º—Å`);try{h&&typeof h=="object"&&Object.defineProperty(h,"_schemaDuration",{value:E,writable:!0,configurable:!0})}catch(A){const T=A instanceof Error?A.message:String(A);console.warn(`Cannot set _schemaDuration on migration module ${(u=h.migrationInfo)==null?void 0:u.fileName}:`,T),g(`‚ö†Ô∏è –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è —Å—Ö–µ–º—ã ${(_=h.migrationInfo)==null?void 0:_.fileName}: ${E}–º—Å (—Å–æ—Ö—Ä–∞–Ω–µ–Ω–æ —Ç–æ–ª—å–∫–æ –≤ –ª–æ–≥–∞—Ö)`)}}g("üèÅ –í—Å–µ –º–∏–≥—Ä–∞—Ü–∏–∏ —Å—Ö–µ–º—ã IndexedDB –≤—ã–ø–æ–ª–Ω–µ–Ω—ã —É—Å–ø–µ—à–Ω–æ. –§–∏–Ω–∞–ª—å–Ω—ã–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞:",Array.from(t.objectStoreNames))}catch(f){throw I("‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤–æ –≤—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π —Å—Ö–µ–º—ã IndexedDB:",f),f}}static setupConnectionHandlers(t){t.onversionchange=function(){g("üîÑ –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è IndexDB (version change)"),z&&(clearTimeout(z),z=null),gt=!0,mt=0,t.close(),Y=null,dt=null,gt=!1},t.onclose=function(){g("üîí –°–æ–µ–¥–∏–Ω–µ–Ω–∏–µ IndexDB –∑–∞–∫—Ä—ã—Ç–æ"),z&&(clearTimeout(z),z=null),mt=0,Y=null,dt=null,gt=!1}}static incrementActiveRequests(){mt++,z&&(clearTimeout(z),z=null)}static decrementActiveRequests(){mt=Math.max(0,mt-1),mt===0&&ft.startCloseTimer()}static startCloseTimer(){z&&clearTimeout(z),z=setTimeout(()=>{Y&&!gt&&mt===0&&(g(`üîí –ó–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è IndexDB –ø–æ —Ç–∞–π–º–∞—É—Ç—É (5 –º–∏–Ω—É—Ç –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤). –ê–∫—Ç–∏–≤–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤: ${mt}`),gt=!0,Y.close(),Y=null,dt=null,z=null,gt=!1)},Io)}static forceCloseConnection(){Y&&(g("üîí –ü—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–µ –∑–∞–∫—Ä—ã—Ç–∏–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏—è IndexDB"),z&&(clearTimeout(z),z=null),gt=!0,mt=0,Y.close(),Y=null,dt=null,gt=!1)}static getConnectionInfo(){return{hasConnection:!!Y,isClosing:gt,activeRequestsCount:mt,hasCloseTimer:!!z,connectionPromiseActive:!!dt}}static async checkMigrationReadiness(){try{const t=await this.getConnection(),e=le(),r=await jt.allUsersReady(t,e),o=await jt.getPendingUsers(t,e);return{isReady:r,pendingUsers:o,systemStatus:r?"ready":o.length>0?"partial":"blocked"}}catch(t){return console.error("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≤–µ—Ä–∫–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–π:",t),{isReady:!1,pendingUsers:[],systemStatus:"blocked"}}}static async getUsersMigrationSummary(){try{const t=await this.getConnection(),e=le(),r=await jt.getUserReadinessStats(t,e),o=await jt.scanAllUserIds(t),i=[];for(const u of o){const _=await $o.getUserMigrationStats(u);i.push({userId:u,currentVersion:(_==null?void 0:_.currentVersion)||0,completedMigrations:(_==null?void 0:_.completedMigrations)||[],isReady:(_==null?void 0:_.currentVersion)===e})}return{totalUsers:r.totalUsers,completedUsers:r.completedUsers,pendingUsers:r.pendingUsers,completionPercentage:r.completionPercentage,userDetails:i}}catch(t){return console.error("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:",t),{totalUsers:0,completedUsers:0,pendingUsers:[],completionPercentage:0,userDetails:[]}}}}const lt={accounts_by_id:{},friends_by_id:{},rooms_by_id:{}};var bo=O('<span class="status-text svelte-4jntj4"> </span>'),Eo=O('<div><span class="status-dot svelte-4jntj4"></span> <!></div>');function Do(s,t){let e=Je(t,"size",3,"md"),r=Je(t,"animated",3,!0),o=Je(t,"className",3,"");const i=()=>{let p=["status-indicator",`status-${t.status}`,`size-${e()}`];return r()&&p.push("animated"),o()&&p.push(o()),p.join(" ")};var u=Eo(),_=d(c(u),2);{var f=p=>{var h=bo(),w=c(h);R(()=>y(w,t.text)),$(p,h)};G(_,p=>{t.text&&p(f)})}R(p=>a(u,1,p,"svelte-4jntj4"),[()=>l(i())]),$(s,u)}var Ao=O('<div><div class="theme-preview svelte-gyqbuc"><span class="theme-icon svelte-gyqbuc"> </span> <div class="theme-info svelte-gyqbuc"><div class="theme-name svelte-gyqbuc"> </div> <div class="theme-description svelte-gyqbuc"> </div></div></div> <div class="theme-actions svelte-gyqbuc"><!></div></div>'),To=O('<div class="theme-selector svelte-gyqbuc"><div class="themes-grid svelte-gyqbuc"></div></div>');function Ro(s,t){Qr(t,!1);const[e,r]=Jr(),o=()=>er(Xr,"$theme",e),i={cyberpunk:"üåÜ",watchdogs:"üîç",pixel:"üéÆ",terminal:"üíª",arabic:"üïå"},u={cyberpunk:"–¢–µ–º–Ω–∞—è –∫–∏–±–µ—Ä–ø–∞–Ω–∫ —Ç–µ–º–∞ —Å –Ω–µ–æ–Ω–æ–≤—ã–º–∏ –∞–∫—Ü–µ–Ω—Ç–∞–º–∏",watchdogs:"–°—Ç–∏–ª—å –≤ –¥—É—Ö–µ —Ö–∞–∫–µ—Ä—Å–∫–∏—Ö —Ñ–∏–ª—å–º–æ–≤",pixel:"–†–µ—Ç—Ä–æ –ø–∏–∫—Å–µ–ª—å–Ω–∞—è –≥—Ä–∞—Ñ–∏–∫–∞",terminal:"–ö–ª–∞—Å—Å–∏—á–µ—Å–∫–∏–π —Ç–µ—Ä–º–∏–Ω–∞–ª—å–Ω—ã–π –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å",arabic:"–¢—Ä–∞–¥–∏—Ü–∏–æ–Ω–Ω—ã–π –∞—Ä–∞–±—Å–∫–∏–π —Å—Ç–∏–ª—å"};Kr();var _=To(),f=c(_);kt(f,5,()=>no,Pt,(p,h)=>{var w=Ao();let E;var A=c(w),T=c(A),st=c(T),Z=d(T,2),bt=c(Z),Et=c(bt),D=d(bt,2),ue=c(D),_e=d(A,2),ge=c(_e);const me=tt(()=>o()===v(h)?"primary":"outline"),fe=tt(()=>o()===v(h));F(ge,{get variant(){return v(me)},size:"sm",onclick:()=>oo(v(h)),get disabled(){return v(fe)},children:(qt,ee)=>{var re=j();R(()=>y(re,o()===v(h)?"‚úì –ê–∫—Ç–∏–≤–Ω–∞":"–ü—Ä–∏–º–µ–Ω–∏—Ç—å")),$(qt,re)},$$slots:{default:!0}}),R((qt,ee)=>{E=a(w,1,"theme-option svelte-gyqbuc",null,E,qt),y(st,i[v(h)]||"üé®"),y(Et,ee),y(ue,u[v(h)])},[()=>({active:o()===v(h)}),()=>v(h).toUpperCase()],tt),$(p,w)}),$(s,_),Zr(),r()}async function is(){try{if("databases"in indexedDB){const s=await indexedDB.databases();console.log(`Found ${s.length} IndexedDB database(s) to delete`);for(const t of s)if(t.name)try{const e=indexedDB.deleteDatabase(t.name);await new Promise((r,o)=>{e.onsuccess=()=>{console.log(`‚úì IndexedDB database deleted: ${t.name}`),r()},e.onerror=i=>{console.error(`Error deleting IndexedDB database: ${t.name}`,i),o(new Error(`Failed to delete database: ${t.name}`))},e.onblocked=()=>{console.warn(`IndexedDB database deletion blocked: ${t.name}`),r()}})}catch(e){console.error(`Error deleting IndexedDB database: ${t.name}`,e)}}else{console.log("Modern databases() API not available, using fallback method");const s=["store_v3","store_v2","store_v1","store"];for(const t of s)try{const e=indexedDB.deleteDatabase(t);await new Promise((r,o)=>{e.onsuccess=()=>{console.log(`‚úì IndexedDB database deleted: ${t}`),r()},e.onerror=()=>{console.log(`IndexedDB database not found or already deleted: ${t}`),r()},e.onblocked=()=>{console.warn(`IndexedDB database deletion blocked: ${t}`),r()}})}catch(e){console.error(`Error deleting IndexedDB database: ${t}`,e)}}console.log("‚úì IndexedDB databases cleared")}catch(s){throw console.error("Error clearing IndexedDB databases:",s),s}}async function xo(){try{if(localStorage.clear(),console.log("‚úì localStorage cleared"),sessionStorage.clear(),console.log("‚úì sessionStorage cleared"),"serviceWorker"in navigator){const s=await navigator.serviceWorker.getRegistrations();if(s.length>0){console.log(`Found ${s.length} service worker(s) to unregister`);for(const t of s)try{await t.unregister(),console.log("‚úì Service worker unregistered:",t.scope)}catch(e){console.error("Error unregistering service worker:",e)}}else console.log("No service workers found")}else console.log("Service Workers not supported in this browser");if("indexedDB"in window)try{await is()}catch(s){console.error("Error clearing IndexedDB:",s)}if("caches"in window)try{const s=await caches.keys();if(s.length>0){console.log(`Found ${s.length} cache(s) to delete`);for(const t of s)await caches.delete(t),console.log("‚úì Cache deleted:",t)}else console.log("No caches found")}catch(s){console.error("Error clearing caches:",s)}console.log("üßπ App data clearing completed"),alert("–í—Å–µ –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –æ—á–∏—â–µ–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞."),window.location.reload()}catch(s){console.error("Error during app data clearing:",s),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ –¥–∞–Ω–Ω—ã—Ö: "+(s instanceof Error?s.message:String(s)))}}async function Mo(){try{if("serviceWorker"in navigator){const s=await navigator.serviceWorker.getRegistrations();if(s.length>0){console.log(`Found ${s.length} service worker(s) to unregister`);for(const t of s)try{await t.unregister(),console.log("‚úì Service worker unregistered:",t.scope)}catch(e){console.error("Error unregistering service worker:",e)}alert("Service Workers –æ—á–∏—â–µ–Ω—ã! –°—Ç—Ä–∞–Ω–∏—Ü–∞ –±—É–¥–µ—Ç –ø–µ—Ä–µ–∑–∞–≥—Ä—É–∂–µ–Ω–∞."),window.location.reload()}else alert("Service Workers –Ω–µ –Ω–∞–π–¥–µ–Ω—ã")}else alert("Service Workers –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞—é—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ")}catch(s){console.error("Error clearing service workers:",s),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ Service Workers: "+(s instanceof Error?s.message:String(s)))}}function Vo(){try{localStorage.clear(),sessionStorage.clear(),console.log("‚úì Storage cleared"),alert("–õ–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ –æ—á–∏—â–µ–Ω–æ!")}catch(s){console.error("Error clearing storage:",s),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞: "+(s instanceof Error?s.message:String(s)))}}async function Oo(){try{"indexedDB"in window?(await is(),alert("IndexedDB –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –æ—á–∏—â–µ–Ω—ã!")):alert("IndexedDB –Ω–µ –ø–æ–¥–¥–µ—Ä–∂–∏–≤–∞–µ—Ç—Å—è –≤ —ç—Ç–æ–º –±—Ä–∞—É–∑–µ—Ä–µ")}catch(s){console.error("Error clearing IndexedDB:",s),alert("–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ—á–∏—Å—Ç–∫–µ IndexedDB: "+(s instanceof Error?s.message:String(s)))}}const Bt={DB_NAME:"ENTITY_VERSIONS_V1",VERSION:1,STORES:{ENTITY_VERSIONS:"entity_versions"}};function Uo(s,t){return`${s}_${t}`}function ko(){return new Promise((s,t)=>{const e=indexedDB.open(Bt.DB_NAME,Bt.VERSION);e.onupgradeneeded=r=>{const o=e.result;o.objectStoreNames.contains(Bt.STORES.ENTITY_VERSIONS)||(o.createObjectStore(Bt.STORES.ENTITY_VERSIONS,{keyPath:"id"}).createIndex("userId","userId",{unique:!1}),g("‚úÖ –°–æ–∑–¥–∞–Ω–æ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ entity_versions"))},e.onsuccess=()=>{s(e.result)},e.onerror=()=>{t(e.error)}})}async function tr(s,t){try{const o=(await ko()).transaction([Bt.STORES.ENTITY_VERSIONS],"readonly").objectStore(Bt.STORES.ENTITY_VERSIONS),i=Uo(s,t),u=o.get(i);return new Promise((_,f)=>{u.onsuccess=()=>{const p=u.result;_((p==null?void 0:p.lastVersion)||0)},u.onerror=()=>{f(u.error)}})}catch(e){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–∏:",{userId:s,entityType:t,error:e}),0}}async function Po(s){try{const[t,e,r]=await Promise.all([tr(s,"accounts"),tr(s,"rooms"),tr(s,"friends")]);return{accounts:t,rooms:e,friends:r}}catch(t){return I("‚ùå –û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å–≤–æ–¥–∫–∏ –≤–µ—Ä—Å–∏–π:",{userId:s,error:t}),{accounts:0,rooms:0,friends:0}}}function Co(){try{const s=new Map;for(const o of Object.values(lt.accounts_by_id)){const i=o.version||0;s.set(i,(s.get(i)||0)+1)}const t=new Map;for(const o of Object.values(lt.rooms_by_id)){const i=o.version||0;t.set(i,(t.get(i)||0)+1)}const e=new Map;for(const o of Object.values(lt.friends_by_id)){const i=o.version||0;e.set(i,(e.get(i)||0)+1)}const r={accounts:Array.from(s.entries()).map(([o,i])=>({version:o,count:i})).sort((o,i)=>o.version-i.version),rooms:Array.from(t.entries()).map(([o,i])=>({version:o,count:i})).sort((o,i)=>o.version-i.version),friends:Array.from(e.entries()).map(([o,i])=>({version:o,count:i})).sort((o,i)=>o.version-i.version)};return g("üìä –ê–Ω–∞–ª–∏–∑ –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π –∑–∞–≤–µ—Ä—à–µ–Ω:",{accountsTotal:Object.keys(lt.accounts_by_id).length,roomsTotal:Object.keys(lt.rooms_by_id).length,friendsTotal:Object.keys(lt.friends_by_id).length,result:r}),r}catch(s){return I("‚ùå –û—à–∏–±–∫–∞ –∞–Ω–∞–ª–∏–∑–∞ –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π:",s),{accounts:[],rooms:[],friends:[]}}}const No="_settingsContainer_1p21f_1",jo="_settingsGrid_1p21f_10",Bo="_settingSection_1p21f_16",Lo="_sectionTitle_1p21f_22",qo="_settingItem_1p21f_33",zo="_settingHeader_1p21f_50",Go="_settingName_1p21f_57",Wo="_settingIcon_1p21f_66",Fo="_settingDescription_1p21f_70",Ho="_settingActions_1p21f_77",Yo="_statusIndicator_1p21f_99",Qo="_statusActive_1p21f_110",Ko="_themeSelector_1p21f_122",Zo="_clearOptions_1p21f_126",Jo="_versionResults_1p21f_180",Xo="_userList_1p21f_187",tn="_userItem_1p21f_193",en="_statsGrid_1p21f_199",rn="_errorMessage_1p21f_206",sn="_authRequired_1p21f_214",on="_authMessage_1p21f_222",nn="_authDescription_1p21f_228",an="_authActions_1p21f_233",cn="_emptyMessage_1p21f_238",dn="_migrationList_1p21f_245",ln="_migrationItem_1p21f_254",vn="_migrationHeader_1p21f_267",un="_migrationDetails_1p21f_274",n={settingsContainer:No,settingsGrid:jo,settingSection:Bo,sectionTitle:Lo,settingItem:qo,settingHeader:zo,settingName:Go,settingIcon:Wo,settingDescription:Fo,settingActions:Ho,statusIndicator:Yo,statusActive:Qo,themeSelector:Ko,clearOptions:Zo,versionResults:Jo,userList:Xo,userItem:tn,statsGrid:en,errorMessage:rn,authRequired:sn,authMessage:on,authDescription:nn,authActions:an,emptyMessage:cn,migrationList:dn,migrationItem:ln,migrationHeader:vn,migrationDetails:un};var _n=O("<div><!> <!> <!> <!></div>"),gn=O("<div><div><strong> </strong></div> <div><span> </span> <span> </span> <span> </span> <span> </span></div></div>"),mn=O("<h4>üîç –î–µ—Ç–∞–ª–∏–∑–∞—Ü–∏—è –ø–æ –º–∏–≥—Ä–∞—Ü–∏—è–º</h4> <div></div>",1),fn=O("<div><h4>üìã –û–±—â–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è</h4> <div><div><strong>–û–±—â–µ–µ –≤—Ä–µ–º—è:</strong> </div> <div><strong>–ü–æ—Å–ª–µ–¥–Ω—è—è –º–∏–≥—Ä–∞—Ü–∏—è:</strong> </div> <div><strong>–í—ã–ø–æ–ª–Ω–µ–Ω–æ –º–∏–≥—Ä–∞—Ü–∏–π:</strong> </div></div> <!></div>"),hn=O("<div> </div>"),pn=O(`<div><div>üîê –î–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–µ—Ä—Å–∏–π –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è</div> <div>–î–∞–Ω–Ω—ã–µ –≤–µ—Ä—Å–∏–π –∑–∞—à–∏—Ñ—Ä–æ–≤–∞–Ω—ã –∏ —Ç—Ä–µ–±—É—é—Ç –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –¥–ª—è
                            –¥–æ—Å—Ç—É–ø–∞.</div> <div><!></div></div>`),Sn=O("<div>–ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –ø—É—Å—Ç–∞</div>"),yn=O("<div> </div>"),wn=O("<div><h4>üë• –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏ –≤ —Å–∏—Å—Ç–µ–º–µ:</h4> <div><!></div> <h4>üìà –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:</h4> <div><div> </div> <div> </div> <div> </div></div> <h4>üë• –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Friends (–≤ –ø–∞–º—è—Ç–∏):</h4> <div><div> </div> <div> </div> <div> </div> <div> </div></div> <h4>üè† –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ Rooms (–≤ –ø–∞–º—è—Ç–∏):</h4> <div><div> </div> <div> </div> <div> </div> <div> </div></div></div>"),$n=O("<div><div>–î–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π —Ç—Ä–µ–±—É–µ—Ç—Å—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è</div> <div>–ê–≤—Ç–æ—Ä–∏–∑—É–π—Ç–µ—Å—å –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –≤–µ—Ä—Å–∏–π –≤–∞—à–∏—Ö –¥–∞–Ω–Ω—ã—Ö</div> <div><!></div></div>"),In=O("<div>–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –∞–∫–∫–∞—É–Ω—Ç–æ–≤</div>"),bn=O("<div><strong> </strong> <!></div>"),En=O("<div>–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –∫–æ–º–Ω–∞—Ç</div>"),Dn=O("<div><strong> </strong> <!></div>"),An=O("<div>–ù–µ—Ç –∑–∞–ø–∏—Å–µ–π –¥—Ä—É–∑–µ–π</div>"),Tn=O("<div><strong> </strong> <!></div>"),Rn=O("<h4>üìà –î–µ—Ç–∞–ª—å–Ω–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –≤–µ—Ä—Å–∏—è–º</h4> <div><h5>üè† Accounts - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Å–∏—è–º:</h5> <div><!></div></div> <div><h5>üí¨ Rooms - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Å–∏—è–º:</h5> <div><!></div></div> <div><h5>üë• Friends - —Ä–∞—Å–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ –ø–æ –≤–µ—Ä—Å–∏—è–º:</h5> <div><!></div></div>",1),xn=O("<div><h4>üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π</h4> <h4>üî¢ –ö–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å—É—â–Ω–æ—Å—Ç–µ–π</h4> <div><div><strong>üè† Accounts:</strong> </div> <div><strong>üí¨ Rooms:</strong> </div> <div><strong>üë• Friends:</strong> </div></div> <h4>üìù –í–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π</h4> <div><div><strong>üè† Accounts version:</strong> </div> <div><strong>üí¨ Rooms version:</strong> </div> <div><strong>üë• Friends version:</strong> </div></div> <h4>‚úÖ –ó–∞–ø–∏—Å–∏ —Å –≤–µ—Ä—Å–∏—è–º–∏</h4> <div><div><strong>üè† Accounts —Å –≤–µ—Ä—Å–∏—è–º–∏:</strong> </div> <div><strong>üí¨ Rooms —Å –≤–µ—Ä—Å–∏—è–º–∏:</strong> </div> <div><strong>üë• Friends —Å –≤–µ—Ä—Å–∏—è–º–∏:</strong> </div></div> <!></div>"),Mn=O(`<div><div><div><h2>üîß –°–∏—Å—Ç–µ–º–Ω—ã–µ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏</h2> <div><div><div><span>üé®</span> –¢–µ–º—ã –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞</div> <!></div> <div>–í—ã–±–µ—Ä–∏—Ç–µ —Ç–µ–º—É –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å–∞ –¥–ª—è –ø–µ—Ä—Å–æ–Ω–∞–ª–∏–∑–∞—Ü–∏–∏ –≤–Ω–µ—à–Ω–µ–≥–æ –≤–∏–¥–∞
                    –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è. –ò–∑–º–µ–Ω–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω—è—é—Ç—Å—è –º–≥–Ω–æ–≤–µ–Ω–Ω–æ.</div> <div><!></div></div> <div><div><div><span>‚ö°</span> –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã</div> <span> </span></div> <div>–°–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç–∞–µ—Ç –≤ —à—Ç–∞—Ç–Ω–æ–º —Ä–µ–∂–∏–º–µ. –í—Å–µ –º–æ–¥—É–ª–∏ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∏—Ä—É—é—Ç
                    –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ.</div> <div><!></div></div></div> <div><h2>üá∑üá∫ –Ø–∑—ã–∫</h2> <div><div><div><span>üåè</span> –ò–∑–º–µ–Ω–∏—Ç—å —è–∑—ã–∫</div> <span>‚óè –î–û–°–¢–£–ü–ù–û</span></div> <div><!></div></div></div> <div><h2>üíæ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã–º–∏</h2> <div><div><div><span>üíΩ</span> –û—á–∏—Å—Ç–∫–∞ –¥–∞–Ω–Ω—ã—Ö</div> <span>‚óè –î–û–°–¢–£–ü–ù–û</span></div> <div>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ª–æ–∫–∞–ª—å–Ω—ã–º–∏ –¥–∞–Ω–Ω—ã–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è, –≤–∫–ª—é—á–∞—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏,
                    –∫—ç—à –∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ –¥–∞–Ω–Ω—ã–µ.</div> <div><!></div> <!></div></div> <div><h2>üóÇÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤–∫–ª–∞–¥–∫–∞–º–∏</h2> <div><div><div><span>üìä</span> –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫</div> <span> </span></div> <div>–û—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–∞ –∞–∫—Ç–∏–≤–Ω—ã—Ö –≤–∫–ª–∞–¥–æ–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤
                    —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏ —á–µ—Ä–µ–∑ SharedWorker. –°—á–µ—Ç—á–∏–∫ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
                    –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏/–∑–∞–∫—Ä—ã—Ç–∏–∏ –≤–∫–ª–∞–¥–æ–∫.</div></div> <div><div><div><span>üö™</span> –ó–∞–∫—Ä—ã—Ç–∏–µ –≤–∫–ª–∞–¥–æ–∫</div> <span>‚óè –î–û–°–¢–£–ü–ù–û</span></div> <div>–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –æ—Ç–∫—Ä—ã—Ç—ã–º–∏ –≤–∫–ª–∞–¥–∫–∞–º–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —á–µ—Ä–µ–∑ broadcast
                    —Å–æ–æ–±—â–µ–Ω–∏—è. –ü–æ–∑–≤–æ–ª—è–µ—Ç –∑–∞–∫—Ä—ã–≤–∞—Ç—å –≤–∫–ª–∞–¥–∫–∏ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ –≤—Å–µ
                    —ç–∫–∑–µ–º–ø–ª—è—Ä—ã –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</div> <div><!> <!></div> <div style="margin-top: 8px; font-size: 0.9em; color: var(--color-text-secondary);">‚ö†Ô∏è "–ó–∞–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏" - –∑–∞–∫—Ä–æ–µ—Ç –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏ –∫—Ä–æ–º–µ
                    —Ç–µ–∫—É—â–µ–π<br/> ‚ö†Ô∏è "–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏" - –∑–∞–∫—Ä–æ–µ—Ç –≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â—É—é –≤–∫–ª–∞–¥–∫—É</div></div></div> <div><h2>‚è±Ô∏è –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –º–∏–≥—Ä–∞—Ü–∏–π</h2> <div><div><div><span>üìä</span> –í—Ä–µ–º—è –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π</div> <span>‚óè –î–û–°–¢–£–ü–ù–û</span></div> <div>–î–µ—Ç–∞–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –≤—Ä–µ–º–µ–Ω–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π –±–∞–∑—ã
                    –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç –ø—Ä–æ–¥–æ–ª–∂–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∫–∞–∂–¥–æ–π –º–∏–≥—Ä–∞—Ü–∏–∏ –∏ –æ–±—â–µ–µ
                    –≤—Ä–µ–º—è.</div> <div><!></div> <!></div></div> <div><h2>üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ –≤–µ—Ä—Å–∏–π</h2> <div><div><div><span>üìä</span> –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π</div> <span>‚óè –î–û–°–¢–£–ü–ù–û</span></div> <div>–ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ —Å—É—â–Ω–æ—Å—Ç–µ–π –≤ –±–∞–∑–µ
                    –¥–∞–Ω–Ω—ã—Ö. –ü–æ–∫–∞–∑—ã–≤–∞–µ—Ç ID –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –∏—Ö —Ç–µ–∫—É—â–∏–µ –≤–µ—Ä—Å–∏–∏.</div> <div><!></div> <!> <!> <!></div></div> <div><h2>üî¢ –í–ï–†–°–ò–ò –°–£–©–ù–û–°–¢–ï–ô</h2> <div><div><div><span>üóÇÔ∏è</span> <span>–í–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π</span></div></div> <div>–û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Ç–µ–∫—É—â–∏–µ –≤–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π –¥–ª—è –æ—Ç–ª–∞–¥–∫–∏ –∏
                    –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞ –º–∏–≥—Ä–∞—Ü–∏–π</div> <div><!></div> <!> <!></div></div> <div><h2>üß≠ –ù–∞–≤–∏–≥–∞—Ü–∏—è</h2> <div><div><div><span>üè†</span> –ì–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞</div></div> <div>–í–µ—Ä–Ω—É—Ç—å—Å—è –Ω–∞ –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.</div> <div><!></div></div></div></div></div>`);function Vn(s,t){Qr(t,!1);const[e,r]=Jr(),o=()=>er(lo,"$appAuthStore",e),i=()=>er(Xr,"$theme",e);let u="operational",_=X(!1),f=X(0),p=X(!1),h=X(!1),w=X(null),E=X(null),A=X(!1),T=X(!1),st=X(!1),Z=X(null),bt=X(!1),Et=X(!1),D=X(null);io(()=>Wr.tabs.subscribeActiveTabsCount(b=>{V(f,b)}));function ue(){V(_,!v(_))}async function _e(){confirm("–í—ã —É–≤–µ—Ä–µ–Ω—ã, —á—Ç–æ —Ö–æ—Ç–∏—Ç–µ –æ—á–∏—Å—Ç–∏—Ç—å –í–°–ï –¥–∞–Ω–Ω—ã–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –Ω–µ–ª—å–∑—è –æ—Ç–º–µ–Ω–∏—Ç—å.")&&await xo()}async function ge(){confirm("–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ Service Workers?")&&await Mo()}function me(){confirm("–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ?")&&Vo()}async function fe(){confirm("–û—á–∏—Å—Ç–∏—Ç—å —Ç–æ–ª—å–∫–æ IndexedDB –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö?")&&await Oo()}const qt=()=>{alert("–î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞ —Å–∏—Å—Ç–µ–º—ã –±—É–¥–µ—Ç —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –≤ —Å–ª–µ–¥—É—é—â–∏—Ö –≤–µ—Ä—Å–∏—è—Ö")};function ee(){confirm("–ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è? –¢–µ–∫—É—â–∞—è –≤–∫–ª–∞–¥–∫–∞ –æ—Å—Ç–∞–Ω–µ—Ç—Å—è –æ—Ç–∫—Ä—ã—Ç–æ–π.")&&Gr.closeAllOtherTabs()}function re(){confirm("–ó–∞–∫—Ä—ã—Ç—å –í–°–ï –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –≤–∫–ª—é—á–∞—è —Ç–µ–∫—É—â—É—é? –≠—Ç–æ –¥–µ–π—Å—Ç–≤–∏–µ –∑–∞–∫—Ä–æ–µ—Ç –≤—Å–µ –æ—Ç–∫—Ä—ã—Ç—ã–µ –≤–∫–ª–∞–¥–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è.")&&Gr.closeAllTabsIncludingCurrent()}async function as(){V(h,!0),V(E,null),V(w,null),V(A,!1);try{const m=o();if(Object.keys(m.byId).length===0){V(A,!0),V(p,!0);return}const S=await ft.getConnection(),M=await jt.getUserReadinessStats(S,2),U=await go.getVersionStats(S),L=await jt.scanAllUserIds(S),x=Object.values(lt.friends_by_id),B=Object.values(lt.rooms_by_id),k={total:x.length,withVersion:x.filter(C=>C.version!==void 0).length,withoutVersion:x.filter(C=>C.version===void 0).length},Q={total:B.length,withVersion:B.filter(C=>C.version!==void 0).length,withoutVersion:B.filter(C=>C.version===void 0).length};V(w,{userStats:M,versionStats:U,allUserIds:Array.from(L),entitiesStats:{friends:k,rooms:Q}}),V(p,!0)}catch(m){V(E,m instanceof Error?m.message:String(m))}finally{V(h,!1)}}async function cs(){V(st,!0);try{const m=await os(ve.MAIN_LES_STORE_V1);V(Z,m),V(T,!0)}catch(m){console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–π:",m),alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É –º–∏–≥—Ä–∞—Ü–∏–π")}finally{V(st,!1)}}async function ds(){V(Et,!0);try{const m=o(),b=Object.keys(m.byId);if(b.length===0){V(A,!0),V(bt,!0);return}const S=b[0];V(A,!1),console.log("üìä –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –≤ back_store..."),await Wr.friends.getList(),await co.fetch({path:"GET_ROOMS"}),console.log("‚úÖ –î–∞–Ω–Ω—ã–µ –∑–∞–≥—Ä—É–∂–µ–Ω—ã –≤ back_store");const M=Co(),U=await Po(S),L=Object.keys(lt.accounts_by_id).length,x=Object.keys(lt.rooms_by_id).length,B=Object.keys(lt.friends_by_id).length,k=M.accounts.filter(P=>P.version>0).reduce((P,H)=>P+H.count,0),Q=M.rooms.filter(P=>P.version>0).reduce((P,H)=>P+H.count,0),C=M.friends.filter(P=>P.version>0).reduce((P,H)=>P+H.count,0);V(D,{accounts:U.accounts,rooms:U.rooms,friends:U.friends,accountsCount:L,roomsCount:x,friendsCount:B,accountsWithVersion:k,roomsWithVersion:Q,friendsWithVersion:C,versionsAnalysis:M}),V(bt,!0)}catch(m){console.error("–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –≤–µ—Ä—Å–∏–π —Å—É—â–Ω–æ—Å—Ç–µ–π:",m),alert("–ù–µ —É–¥–∞–ª–æ—Å—å –∑–∞–≥—Ä—É–∑–∏—Ç—å –≤–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π")}finally{V(Et,!1)}}function se(m){return m<1e3?`${m}–º—Å`:m<6e4?`${(m/1e3).toFixed(1)}—Å`:`${(m/6e4).toFixed(1)}–º–∏–Ω`}Kr();var he=Mn(),sr=c(he),pe=c(sr),or=c(pe),Se=d(or,2),ye=c(Se),we=c(ye),ls=c(we),vs=d(we,2);const us=tt(()=>i().toUpperCase()),_s=tt(()=>`${n.statusIndicator} ${n.statusActive}`);Do(vs,{status:"active",get text(){return v(us)},get className(){return v(_s)}});var nr=d(ye,2),ir=d(nr,2),gs=c(ir);Ro(gs,{});var ar=d(Se,2),$e=c(ar),Ie=c($e),ms=c(Ie),cr=d(Ie,2),fs=c(cr),dr=d($e,2),lr=d(dr,2),hs=c(lr);F(hs,{variant:"outline",size:"sm",onclick:qt,children:(m,b)=>{var S=j("üîç –î–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∞");$(m,S)},$$slots:{default:!0}});var be=d(pe,2),vr=c(be),ur=d(vr,2),Ee=c(ur),De=c(Ee),ps=c(De),Ss=d(De,2),_r=d(Ee,2),ys=c(_r);F(ys,{variant:"outline",size:"sm",onclick:()=>ao.setPath(ie.SELECT_LANG),children:(m,b)=>{var S=j("–í—ã–±—Ä–∞—Ç—å –¥—Ä—É–≥–æ–π —è–∑—ã–∫");$(m,S)},$$slots:{default:!0}});var Ae=d(be,2),gr=c(Ae),mr=d(gr,2),Te=c(mr),Re=c(Te),ws=c(Re),$s=d(Re,2),fr=d(Te,2),xe=d(fr,2),Is=c(xe);F(Is,{variant:"outline",size:"sm",onclick:ue,children:(m,b)=>{var S=j();R(()=>y(S,v(_)?"–°–∫—Ä—ã—Ç—å –æ–ø—Ü–∏–∏":"–ü–æ–∫–∞–∑–∞—Ç—å –æ–ø—Ü–∏–∏ –æ—á–∏—Å—Ç–∫–∏")),$(m,S)},$$slots:{default:!0}});var bs=d(xe,2);{var Es=m=>{var b=_n(),S=c(b);F(S,{variant:"danger",size:"sm",onclick:_e,children:(x,B)=>{var k=j("üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ –¥–∞–Ω–Ω—ã–µ");$(x,k)},$$slots:{default:!0}});var M=d(S,2);F(M,{variant:"outline",size:"sm",onclick:ge,children:(x,B)=>{var k=j("üîß –û—á–∏—Å—Ç–∏—Ç—å Service Workers");$(x,k)},$$slots:{default:!0}});var U=d(M,2);F(U,{variant:"outline",size:"sm",onclick:me,children:(x,B)=>{var k=j("üíæ –û—á–∏—Å—Ç–∏—Ç—å –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ");$(x,k)},$$slots:{default:!0}});var L=d(U,2);F(L,{variant:"outline",size:"sm",onclick:fe,children:(x,B)=>{var k=j("üóÑÔ∏è –û—á–∏—Å—Ç–∏—Ç—å IndexedDB");$(x,k)},$$slots:{default:!0}}),R(()=>a(b,1,l(n.clearOptions))),$(m,b)};G(bs,m=>{v(_)&&m(Es)})}var Me=d(Ae,2),hr=c(Me),Ve=d(hr,2),Oe=c(Ve),Ue=c(Oe),Ds=c(Ue),pr=d(Ue,2),As=c(pr),Ts=d(Oe,2),Sr=d(Ve,2),ke=c(Sr),Pe=c(ke),Rs=c(Pe),xs=d(Pe,2),yr=d(ke,2),Ce=d(yr,2),wr=c(Ce);F(wr,{variant:"outline",size:"sm",onclick:ee,children:(m,b)=>{var S=j("üóÇÔ∏è –ó–∞–∫—Ä—ã—Ç—å –æ—Å—Ç–∞–ª—å–Ω—ã–µ –≤–∫–ª–∞–¥–∫–∏");$(m,S)},$$slots:{default:!0}});var Ms=d(wr,2);F(Ms,{variant:"danger",size:"sm",onclick:re,children:(m,b)=>{var S=j("‚ùå –ó–∞–∫—Ä—ã—Ç—å –≤—Å–µ –≤–∫–ª–∞–¥–∫–∏");$(m,S)},$$slots:{default:!0}});var Vs=d(Ce,2),Ne=d(Me,2),$r=c(Ne),Ir=d($r,2),je=c(Ir),Be=c(je),Os=c(Be),Us=d(Be,2),br=d(je,2),Le=d(br,2),ks=c(Le);F(ks,{variant:"outline",size:"sm",onclick:cs,get disabled(){return v(st)},children:(m,b)=>{var S=j();R(()=>y(S,v(st)?"üîÑ –ó–∞–≥—Ä—É–∑–∫–∞...":"üìà –ü–æ–∫–∞–∑–∞—Ç—å —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É")),$(m,S)},$$slots:{default:!0}});var Ps=d(Le,2);{var Cs=m=>{var b=fn(),S=d(c(b),2),M=c(S),U=d(c(M)),L=d(M,2),x=d(c(L)),B=d(L,2),k=d(c(B)),Q=d(S,2);{var C=P=>{var H=mn(),ht=d(Ut(H),2);kt(ht,5,()=>v(Z).executedMigrations,Pt,(At,ot)=>{var ut=gn(),pt=c(ut),Tt=c(pt),Rt=c(Tt),xt=d(pt,2),Mt=c(xt),Vt=c(Mt),Dt=d(Mt,2),zt=c(Dt),nt=d(Dt,2),St=c(nt),_t=d(nt,2),Ot=c(_t);R((Gt,Wt,et,J)=>{a(ut,1,l(n.migrationItem)),a(pt,1,l(n.migrationHeader)),y(Rt,`v${v(ot).version??""} - ${v(ot).fileName??""}`),a(xt,1,l(n.migrationDetails)),y(Vt,`–°—Ö–µ–º–∞: ${Gt??""}`),y(zt,`–î–∞–Ω–Ω—ã–µ: ${Wt??""}`),y(St,`–û–±—â–µ–µ: ${et??""}`),y(Ot,`–ó–∞–≤–µ—Ä—à–µ–Ω–∞: ${J??""}`)},[()=>se(v(ot).schemaDuration),()=>se(v(ot).dataDuration),()=>se(v(ot).schemaDuration+v(ot).dataDuration),()=>new Date(v(ot).endTime).toLocaleTimeString()],tt),$(At,ut)}),R(()=>a(ht,1,l(n.migrationList))),$(P,H)};G(Q,P=>{v(Z).executedMigrations.length>0&&P(C)})}R((P,H)=>{a(b,1,l(n.versionResults)),a(S,1,l(n.statsGrid)),y(U,` ${P??""}`),y(x,` ${H??""}`),y(k,` ${v(Z).executedMigrations.length??""}`)},[()=>se(v(Z).totalDuration),()=>v(Z).lastMigrationDate?v(Z).lastMigrationDate.toLocaleString():"–ù–µ –≤—ã–ø–æ–ª–Ω—è–ª–∞—Å—å"],tt),$(m,b)};G(Ps,m=>{v(T)&&v(Z)&&m(Cs)})}var qe=d(Ne,2),Er=c(qe),Dr=d(Er,2),ze=c(Dr),Ge=c(ze),Ns=c(Ge),js=d(Ge,2),Ar=d(ze,2),We=d(Ar,2),Bs=c(We);F(Bs,{variant:"outline",size:"sm",onclick:as,get disabled(){return v(h)},children:(m,b)=>{var S=j();R(()=>y(S,v(h)?"‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...":"üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏")),$(m,S)},$$slots:{default:!0}});var Tr=d(We,2);{var Ls=m=>{var b=hn(),S=c(b);R(()=>{a(b,1,l(n.errorMessage)),y(S,`‚ùå –û—à–∏–±–∫–∞: ${v(E)??""}`)}),$(m,b)};G(Tr,m=>{v(E)&&m(Ls)})}var Rr=d(Tr,2);{var qs=m=>{var b=pn(),S=c(b),M=d(S,2),U=d(M,2),L=c(U);Xe(L,{get href(){return ie.AUTH},children:(x,B)=>{F(x,{variant:"primary",size:"sm",children:(k,Q)=>{var C=j("–ü–µ—Ä–µ–π—Ç–∏ –∫ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏");$(k,C)},$$slots:{default:!0}})},$$slots:{default:!0}}),R(()=>{a(b,1,l(n.authRequired)),a(S,1,l(n.authMessage)),a(M,1,l(n.authDescription)),a(U,1,l(n.authActions))}),$(m,b)};G(Rr,m=>{v(p)&&v(A)&&m(qs)})}var zs=d(Rr,2);{var Gs=m=>{var b=wn(),S=d(c(b),2),M=c(S);{var U=et=>{var J=Sn();R(()=>a(J,1,l(n.emptyMessage))),$(et,J)},L=et=>{var J=ae(),oe=Ut(J);kt(oe,1,()=>v(w).allUserIds,Pt,(Ke,Ze)=>{var Ft=yn(),ne=c(Ft);R(()=>{a(Ft,1,l(n.userItem)),y(ne,`User ID: ${v(Ze)??""} | Version: ${v(w).userStats.completedUsers>0?"2":"1"}`)}),$(Ke,Ft)}),$(et,J)};G(M,et=>{v(w).allUserIds.length===0?et(U):et(L,!1)})}var x=d(S,4),B=c(x),k=c(B),Q=d(B,2),C=c(Q),P=d(Q,2),H=c(P),ht=d(x,4),At=c(ht),ot=c(At),ut=d(At,2),pt=c(ut),Tt=d(ut,2),Rt=c(Tt),xt=d(Tt,2),Mt=c(xt),Vt=d(ht,4),Dt=c(Vt),zt=c(Dt),nt=d(Dt,2),St=c(nt),_t=d(nt,2),Ot=c(_t),Gt=d(_t,2),Wt=c(Gt);R((et,J)=>{a(b,1,l(n.versionResults)),a(S,1,l(n.userList)),a(x,1,l(n.statsGrid)),y(k,`–í—Å–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π: ${v(w).userStats.totalUsers??""}`),y(C,`–ó–∞–≤–µ—Ä—à–∏–ª–∏ –º–∏–≥—Ä–∞—Ü–∏—é: ${v(w).userStats.completedUsers??""}`),y(H,`–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: ${v(w).userStats.completionPercentage??""}%`),a(ht,1,l(n.statsGrid)),y(ot,`–í—Å–µ–≥–æ friends: ${v(w).entitiesStats.friends.total??""}`),y(pt,`–° –≤–µ—Ä—Å–∏–µ–π: ${v(w).entitiesStats.friends.withVersion??""}`),y(Rt,`–ë–µ–∑ –≤–µ—Ä—Å–∏–∏: ${v(w).entitiesStats.friends.withoutVersion??""}`),y(Mt,`–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: ${et??""}%`),a(Vt,1,l(n.statsGrid)),y(zt,`–í—Å–µ–≥–æ rooms: ${v(w).entitiesStats.rooms.total??""}`),y(St,`–° –≤–µ—Ä—Å–∏–µ–π: ${v(w).entitiesStats.rooms.withVersion??""}`),y(Ot,`–ë–µ–∑ –≤–µ—Ä—Å–∏–∏: ${v(w).entitiesStats.rooms.withoutVersion??""}`),y(Wt,`–ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å: ${J??""}%`)},[()=>v(w).entitiesStats.friends.total>0?Math.round(v(w).entitiesStats.friends.withVersion/v(w).entitiesStats.friends.total*100):100,()=>v(w).entitiesStats.rooms.total>0?Math.round(v(w).entitiesStats.rooms.withVersion/v(w).entitiesStats.rooms.total*100):100],tt),$(m,b)};G(zs,m=>{v(p)&&v(w)&&!v(A)&&m(Gs)})}var Fe=d(qe,2),xr=c(Fe),Mr=d(xr,2),He=c(Mr),Vr=c(He),Or=c(Vr),Ws=d(Or,2),Ur=d(He,2),Ye=d(Ur,2),Fs=c(Ye);F(Fs,{variant:"outline",size:"sm",get disabled(){return v(Et)},onclick:ds,children:(m,b)=>{var S=j();R(()=>y(S,v(Et)?"‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞...":"üîç –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –≤–µ—Ä—Å–∏–∏")),$(m,S)},$$slots:{default:!0}});var kr=d(Ye,2);{var Hs=m=>{var b=$n(),S=c(b),M=d(S,2),U=d(M,2),L=c(U);Xe(L,{get href(){return ie.AUTH},children:(x,B)=>{F(x,{variant:"primary",size:"sm",children:(k,Q)=>{var C=j("üîë –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è");$(k,C)},$$slots:{default:!0}})},$$slots:{default:!0}}),R(()=>{a(b,1,l(n.authRequired)),a(S,1,l(n.authMessage)),a(M,1,l(n.authDescription)),a(U,1,l(n.authActions))}),$(m,b)};G(kr,m=>{v(bt)&&v(A)&&m(Hs)})}var Ys=d(kr,2);{var Qs=m=>{var b=xn(),S=d(c(b),4),M=c(S),U=d(c(M)),L=d(M,2),x=d(c(L)),B=d(L,2),k=d(c(B)),Q=d(S,4),C=c(Q),P=d(c(C)),H=d(C,2),ht=d(c(H)),At=d(H,2),ot=d(c(At)),ut=d(Q,4),pt=c(ut),Tt=d(c(pt)),Rt=d(pt,2),xt=d(c(Rt)),Mt=d(Rt,2),Vt=d(c(Mt)),Dt=d(ut,2);{var zt=nt=>{var St=Rn(),_t=d(Ut(St),2),Ot=d(c(_t),2),Gt=c(Ot);{var Wt=N=>{var q=In();R(()=>a(q,1,l(n.emptyMessage))),$(N,q)},et=N=>{var q=ae(),Ht=Ut(q);kt(Ht,1,()=>v(D).versionsAnalysis.accounts,Pt,(Yt,it)=>{var at=bn(),yt=c(at),Qt=c(yt),wt=d(yt),Kt=d(wt);{var Zt=ct=>{var $t=j();R(Jt=>y($t,`(${Jt??""}%)`),[()=>(v(it).count/v(D).accountsCount*100).toFixed(1)],tt),$(ct,$t)};G(Kt,ct=>{v(D).accountsCount>0&&ct(Zt)})}R(()=>{a(at,1,l(n.versionItem)),y(Qt,`–í–µ—Ä—Å–∏—è ${v(it).version??""}:`),y(wt,` ${v(it).count??""} –∑–∞–ø–∏—Å–µ–π `)}),$(Yt,at)}),$(N,q)};G(Gt,N=>{v(D).versionsAnalysis.accounts.length===0?N(Wt):N(et,!1)})}var J=d(_t,2),oe=d(c(J),2),Ke=c(oe);{var Ze=N=>{var q=En();R(()=>a(q,1,l(n.emptyMessage))),$(N,q)},Ft=N=>{var q=ae(),Ht=Ut(q);kt(Ht,1,()=>v(D).versionsAnalysis.rooms,Pt,(Yt,it)=>{var at=Dn(),yt=c(at),Qt=c(yt),wt=d(yt),Kt=d(wt);{var Zt=ct=>{var $t=j();R(Jt=>y($t,`(${Jt??""}%)`),[()=>(v(it).count/v(D).roomsCount*100).toFixed(1)],tt),$(ct,$t)};G(Kt,ct=>{v(D).roomsCount>0&&ct(Zt)})}R(()=>{a(at,1,l(n.versionItem)),y(Qt,`–í–µ—Ä—Å–∏—è ${v(it).version??""}:`),y(wt,` ${v(it).count??""} –∑–∞–ø–∏—Å–µ–π `)}),$(Yt,at)}),$(N,q)};G(Ke,N=>{v(D).versionsAnalysis.rooms.length===0?N(Ze):N(Ft,!1)})}var ne=d(J,2),qr=d(c(ne),2),Js=c(qr);{var Xs=N=>{var q=An();R(()=>a(q,1,l(n.emptyMessage))),$(N,q)},to=N=>{var q=ae(),Ht=Ut(q);kt(Ht,1,()=>v(D).versionsAnalysis.friends,Pt,(Yt,it)=>{var at=Tn(),yt=c(at),Qt=c(yt),wt=d(yt),Kt=d(wt);{var Zt=ct=>{var $t=j();R(Jt=>y($t,`(${Jt??""}%)`),[()=>(v(it).count/v(D).friendsCount*100).toFixed(1)],tt),$(ct,$t)};G(Kt,ct=>{v(D).friendsCount>0&&ct(Zt)})}R(()=>{a(at,1,l(n.versionItem)),y(Qt,`–í–µ—Ä—Å–∏—è ${v(it).version??""}:`),y(wt,` ${v(it).count??""} –∑–∞–ø–∏—Å–µ–π `)}),$(Yt,at)}),$(N,q)};G(Js,N=>{v(D).versionsAnalysis.friends.length===0?N(Xs):N(to,!1)})}R(()=>{a(_t,1,l(n.versionDetailSection)),a(Ot,1,l(n.versionStats)),a(J,1,l(n.versionDetailSection)),a(oe,1,l(n.versionStats)),a(ne,1,l(n.versionDetailSection)),a(qr,1,l(n.versionStats))}),$(nt,St)};G(Dt,nt=>{v(D).versionsAnalysis&&nt(zt)})}R((nt,St,_t)=>{a(b,1,l(n.versionResults)),a(S,1,l(n.statsGrid)),y(U,` ${v(D).accountsCount??""} –∑–∞–ø–∏—Å–µ–π`),y(x,` ${v(D).roomsCount??""} –∑–∞–ø–∏—Å–µ–π`),y(k,` ${v(D).friendsCount??""} –∑–∞–ø–∏—Å–µ–π`),a(Q,1,l(n.statsGrid)),y(P,` ${v(D).accounts??""}`),y(ht,` ${v(D).rooms??""}`),y(ot,` ${v(D).friends??""}`),a(ut,1,l(n.statsGrid)),y(Tt,` ${v(D).accountsWithVersion??""} –∏–∑ ${v(D).accountsCount??""}
                                (${nt??""}%)`),y(xt,` ${v(D).roomsWithVersion??""} –∏–∑ ${v(D).roomsCount??""}
                                (${St??""}%)`),y(Vt,` ${v(D).friendsWithVersion??""} –∏–∑ ${v(D).friendsCount??""}
                                (${_t??""}%)`)},[()=>v(D).accountsCount>0?(v(D).accountsWithVersion/v(D).accountsCount*100).toFixed(1):0,()=>v(D).roomsCount>0?(v(D).roomsWithVersion/v(D).roomsCount*100).toFixed(1):0,()=>v(D).friendsCount>0?(v(D).friendsWithVersion/v(D).friendsCount*100).toFixed(1):0],tt),$(m,b)};G(Ys,m=>{v(bt)&&v(D)&&!v(A)&&m(Qs)})}var Pr=d(Fe,2),Cr=c(Pr),Nr=d(Cr,2),Qe=c(Nr),jr=c(Qe),Ks=c(jr),Br=d(Qe,2),Lr=d(Br,2),Zs=c(Lr);Xe(Zs,{get href(){return ie.HOME},children:(m,b)=>{F(m,{variant:"outline",size:"sm",children:(S,M)=>{var U=j("–ü–µ—Ä–µ–π—Ç–∏ –Ω–∞ –≥–ª–∞–≤–Ω—É—é");$(S,U)},$$slots:{default:!0}})},$$slots:{default:!0}}),R(m=>{a(he,1,l(n.settingsContainer)),a(sr,1,l(n.settingsGrid)),a(pe,1,l(n.settingSection)),a(or,1,l(n.sectionTitle)),a(Se,1,l(n.settingItem)),a(ye,1,l(n.settingHeader)),a(we,1,l(n.settingName)),a(ls,1,l(n.settingIcon)),a(nr,1,l(n.settingDescription)),a(ir,1,l(n.themeSelector)),a(ar,1,l(n.settingItem)),a($e,1,l(n.settingHeader)),a(Ie,1,l(n.settingName)),a(ms,1,l(n.settingIcon)),a(cr,1,`${n.statusIndicator} ${n.statusActive}`),y(fs,`‚óè ${m??""}`),a(dr,1,l(n.settingDescription)),a(lr,1,l(n.settingActions)),a(be,1,l(n.settingSection)),a(vr,1,l(n.sectionTitle)),a(ur,1,l(n.settingItem)),a(Ee,1,l(n.settingHeader)),a(De,1,l(n.settingName)),a(ps,1,l(n.settingIcon)),a(Ss,1,`${n.statusIndicator} ${n.statusActive}`),a(_r,1,l(n.settingActions)),a(Ae,1,l(n.settingSection)),a(gr,1,l(n.sectionTitle)),a(mr,1,l(n.settingItem)),a(Te,1,l(n.settingHeader)),a(Re,1,l(n.settingName)),a(ws,1,l(n.settingIcon)),a($s,1,`${n.statusIndicator} ${n.statusActive}`),a(fr,1,l(n.settingDescription)),a(xe,1,l(n.settingActions)),a(Me,1,l(n.settingSection)),a(hr,1,l(n.sectionTitle)),a(Ve,1,l(n.settingItem)),a(Oe,1,l(n.settingHeader)),a(Ue,1,l(n.settingName)),a(Ds,1,l(n.settingIcon)),a(pr,1,`${n.statusIndicator} ${n.statusActive}`),y(As,`‚óè ${v(f)??""} –ê–ö–¢–ò–í–ù–´–•`),a(Ts,1,l(n.settingDescription)),a(Sr,1,l(n.settingItem)),a(ke,1,l(n.settingHeader)),a(Pe,1,l(n.settingName)),a(Rs,1,l(n.settingIcon)),a(xs,1,`${n.statusIndicator} ${n.statusActive}`),a(yr,1,l(n.settingDescription)),a(Ce,1,l(n.settingActions)),a(Vs,1,l(n.settingDescription)),a(Ne,1,l(n.settingSection)),a($r,1,l(n.sectionTitle)),a(Ir,1,l(n.settingItem)),a(je,1,l(n.settingHeader)),a(Be,1,l(n.settingName)),a(Os,1,l(n.settingIcon)),a(Us,1,`${n.statusIndicator} ${n.statusActive}`),a(br,1,l(n.settingDescription)),a(Le,1,l(n.settingActions)),a(qe,1,l(n.settingSection)),a(Er,1,l(n.sectionTitle)),a(Dr,1,l(n.settingItem)),a(ze,1,l(n.settingHeader)),a(Ge,1,l(n.settingName)),a(Ns,1,l(n.settingIcon)),a(js,1,`${n.statusIndicator} ${n.statusActive}`),a(Ar,1,l(n.settingDescription)),a(We,1,l(n.settingActions)),a(Fe,1,l(n.settingSection)),a(xr,1,l(n.sectionTitle)),a(Mr,1,l(n.settingItem)),a(He,1,l(n.settingHeader)),a(Vr,1,l(n.settingName)),a(Or,1,l(n.settingIcon)),a(Ws,1,l(v(Et)?"‚è≥ –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤–µ—Ä—Å–∏–π...":"üóÇÔ∏è –í–µ—Ä—Å–∏–∏ —Å—É—â–Ω–æ—Å—Ç–µ–π")),a(Ur,1,l(n.settingDescription)),a(Ye,1,l(n.settingActions)),a(Pr,1,l(n.settingSection)),a(Cr,1,l(n.sectionTitle)),a(Nr,1,l(n.settingItem)),a(Qe,1,l(n.settingHeader)),a(jr,1,l(n.settingName)),a(Ks,1,l(n.settingIcon)),a(Br,1,l(n.settingDescription)),a(Lr,1,l(n.settingActions))},[()=>u.toUpperCase()],tt),$(s,he),Zr(),r()}function Cn(s){vo(s,{title:"–°–ò–°–¢–ï–ú–ê_–ù–ê–°–¢–†–û–ï–ö",subtitle:"–ö–û–ù–§–ò–ì–£–†–ê–¶–ò–Ø_–ò_–£–ü–†–ê–í–õ–ï–ù–ò–ï_–°–ò–°–¢–ï–ú–û–ô",pageName:"SettingsPage",children:(t,e)=>{Vn(t,{})},$$slots:{default:!0}})}export{Cn as default};
