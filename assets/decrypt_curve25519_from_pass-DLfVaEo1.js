import{aq as t,ar as e,K as w,as as b}from"./index-BrsrtigZ.js";async function m(r){t("üîë generate_keys_curve25519_from_password: –ù–∞—á–∏–Ω–∞–µ–º –≥–µ–Ω–µ—Ä–∞—Ü–∏—é –∫–ª—é—á–µ–π..."),t("üîë –ü–∞—Ä–æ–ª—å –¥–ª–∏–Ω–∞:",r==null?void 0:r.length,"—Å–∏–º–≤–æ–ª–æ–≤"),t("‚è∞ –ñ–¥–µ–º sodium.ready –≤ generate_keys...");const n=Date.now();await e.ready;const o=Date.now()-n;t("‚úÖ sodium.ready –≤ generate_keys –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞",o,"–º—Å"),t("üé≤ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º —Å–æ–ª—å...");const a=Date.now(),y=e.randombytes_buf(16),c=Date.now()-a;t("‚úÖ –°–æ–ª—å —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω–∞ –∑–∞",c,"–º—Å"),t("üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –ø–∞—Ä–æ–ª—å –≤ –±–∞–π—Ç—ã...");const i=e.from_string(r);t("üîÑ –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–µ–≤–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª...");const _=Date.now(),p=e.crypto_generichash(32,i,null),l=Date.now()-_;t("‚úÖ –ö–ª—é—á–µ–≤–æ–π –º–∞—Ç–µ—Ä–∏–∞–ª —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∑–∞",l,"–º—Å"),t("üîê –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á...");const d=Date.now(),u=e.crypto_scalarmult_base(p),s=Date.now()-d;t("‚úÖ –ü—Ä–∏–≤–∞—Ç–Ω—ã–π –∫–ª—é—á —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∑–∞",s,"–º—Å"),t("üîê –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –ø—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á...");const D=Date.now(),f=e.crypto_scalarmult_base(u),h=Date.now()-D;t("‚úÖ –ü—É–±–ª–∏—á–Ω—ã–π –∫–ª—é—á —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω –∑–∞",h,"–º—Å"),t("üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –∫–ª—é—á–∏ –≤ hex...");const v={privateKey:e.to_hex(u),publicKey:e.to_hex(f),salt:e.to_hex(y)};return t("‚úÖ generate_keys_curve25519_from_password –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ"),v}async function x({pass:r,message:n}){try{t("üîê encrypt_curve25519_from_pass: –ù–∞—á–∏–Ω–∞–µ–º —à–∏—Ñ—Ä–æ–≤–∞–Ω–∏–µ..."),t("üîê –†–∞–∑–º–µ—Ä –ø–∞—Ä–æ–ª—è:",r==null?void 0:r.length,"—Å–∏–º–≤–æ–ª–æ–≤"),t("üîê –†–∞–∑–º–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏—è:",n==null?void 0:n.length,"—Å–∏–º–≤–æ–ª–æ–≤"),t("‚è∞ –ñ–¥–µ–º sodium.ready...");const o=Date.now();await e.ready;const a=Date.now()-o;t("‚úÖ sodium.ready –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞",a,"–º—Å"),t("üîë –ì–µ–Ω–µ—Ä–∏—Ä—É–µ–º –∫–ª—é—á–∏ –∏–∑ –ø–∞—Ä–æ–ª—è...");const y=Date.now(),{publicKey:c}=await m(r),i=Date.now()-y;t("‚úÖ –ö–ª—é—á–∏ —Å–≥–µ–Ω–µ—Ä–∏—Ä–æ–≤–∞–Ω—ã –∑–∞",i,"–º—Å"),t("üîÑ –û–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ–º –∫–ª—é—á...");const _=typeof c=="string"?e.from_hex(c):c;t("üìù –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ...");const p=e.from_string(n);t("üîê –í—ã–ø–æ–ª–Ω—è–µ–º crypto_box_seal...");const l=Date.now(),d=e.crypto_box_seal(p,_),u=Date.now()-l;t("‚úÖ crypto_box_seal –∑–∞–≤–µ—Ä—à–µ–Ω –∑–∞",u,"–º—Å"),t("üîÑ –ö–æ–Ω–≤–µ—Ä—Ç–∏—Ä—É–µ–º –≤ hex...");const s=e.to_hex(d);return t("‚úÖ encrypt_curve25519_from_pass –∑–∞–≤–µ—Ä—à–µ–Ω —É—Å–ø–µ—à–Ω–æ, —Ä–∞–∑–º–µ—Ä —Ä–µ–∑—É–ª—å—Ç–∞—Ç–∞:",s==null?void 0:s.length),s}catch(o){return w("‚ùå –û—à–∏–±–∫–∞ –≤ encrypt_curve25519_from_pass:",o),null}}async function g({cipherText:r,pass:n}){try{await e.ready;const{privateKey:o,publicKey:a}=await m(n),y=typeof o=="string"?e.from_hex(o):o,c=typeof a=="string"?e.from_hex(a):a,i=typeof r=="string"?e.from_hex(r):r,_=e.crypto_box_seal_open(i,c,y);return b(_)}catch{return null}}export{g as d,x as e};
