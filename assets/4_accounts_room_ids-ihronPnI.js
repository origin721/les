import{p as t,b as u,c as D,a,e as h}from"./sharedWorker-DfhmEAGI.js";const w={version:4,name:"accounts_room_ids",description:"–î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—è roomIds –∫ accounts",fileName:"4_accounts_room_ids.ts"};function I(d){t("üì¶ –í—ã–ø–æ–ª–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é —Å—Ö–µ–º—ã 4: –±–µ–∑ –∏–∑–º–µ–Ω–µ–Ω–∏–π"),t("‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è —Å—Ö–µ–º—ã 4 –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ")}async function b(d){const{db:_,currentUser:e}=d;return t(`üîÑ –í—ã–ø–æ–ª–Ω—è–µ–º –º–∏–≥—Ä–∞—Ü–∏—é –¥–∞–Ω–Ω—ã—Ö 4 –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è: ${e.id}`),new Promise((p,s)=>{try{const o=_.transaction(["accounts"],"readwrite"),m=o.objectStore("accounts"),c=m.getAll();c.onsuccess=async function(){try{const n=c.result;if(n.length===0){t("‚úÖ –ù–µ—Ç –∑–∞–ø–∏—Å–µ–π accounts –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–∏"),p();return}t(`üìã –ù–∞–π–¥–µ–Ω–æ ${n.length} –∑–∞–ø–∏—Å–µ–π accounts`);let f=0;for(const r of n){u(`üîÑ –ü—Ä–æ–≤–µ—Ä—è–µ–º –∑–∞–ø–∏—Å—å account ${r.id}`);const g=await D({pass:e.pass,cipherText:r.data});if(!g){a(`üí• –ü–û–í–†–ï–ñ–î–ï–ù–ù–´–ï –î–ê–ù–ù–´–ï: account ${r.id}`);continue}const i=JSON.parse(g);if(i.version>=2){u(`‚è≠Ô∏è –ó–∞–ø–∏—Å—å account ${r.id} —É–∂–µ –∏–º–µ–µ—Ç –≤–µ—Ä—Å–∏—é ${i.version}`);continue}const l={...i,roomIds:[],version:2,date_updated:new Date},y=await h({pass:e.pass,message:JSON.stringify(l)}),$={id:r.id,data:y};m.put($),f++,u(`‚úÖ –ó–∞–ø–∏—Å—å account ${r.id} –æ–±–Ω–æ–≤–ª–µ–Ω–∞ —Å roomIds`)}o.oncomplete=function(){t("‚úÖ –ú–∏–≥—Ä–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö 4 –∑–∞–≤–µ—Ä—à–µ–Ω–∞"),t(`üìä –ú–∏–≥—Ä–∏—Ä–æ–≤–∞–Ω–æ: ${f} accounts`),p()},o.onerror=function(){a("‚ùå –û—à–∏–±–∫–∞ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏ –ø—Ä–∏ –º–∏–≥—Ä–∞—Ü–∏–∏:",o.error),s(o.error)}}catch(n){a("‚ùå –û—à–∏–±–∫–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏ –¥–∞–Ω–Ω—ã—Ö:",n),s(n)}},c.onerror=function(){a("‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ —á—Ç–µ–Ω–∏–∏ accounts:",c.error),s(c.error)}}catch(o){a("‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞ –≤ migrationData:",o),s(o)}})}export{b as migrationData,w as migrationInfo,I as migrationScheme};
